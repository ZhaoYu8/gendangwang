(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DeliverGoods"],{"08aa":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:"",visible:e.dialogVisible,width:"96%",top:"10vh"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.cancel(!1)}}},[a("div",{ref:"printMe",style:{fontSize:e.fontSize+"px"},attrs:{id:"printMe"}},[a("ul",{staticClass:"top"},[a("li",[e._v("日期 : "+e._s(e.headerData.delivery_date))]),a("li",[e._v("车号 : "+e._s(e.headerData.delivery_train))]),a("li",[e._v("司机 : "+e._s(e.headerData.delivery_member))]),a("li",[e._v("跟车 : "+e._s(e.headerData.with_member))]),a("li",[e._v("配货员 : "+e._s(e.headerData.allocate_member))]),a("li",[e._v("单号 : "+e._s(e.headerData.delivery_serial))])]),a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[a("tr",{staticStyle:{"background-color":"#5491ff"}},e._l(e.arr,(function(t){return a("td",{key:t.label,style:{width:t.width}},[e._v(e._s(t.label))])})),0),e._l(e.tableData,(function(t,r){return[r>0&&e.tableData[r-1].receiving_unit!==e.tableData[r].receiving_unit?a("tr",{key:t.product_name+r,staticStyle:{height:"10px"}}):e._e(),a("tr",{key:t.receiving_unit+r},e._l(e.arr,(function(i){return a("td",{key:i.id},[e._v(e._s("index"!==i.id?t[i.id]:r+1))])})),0)]}))],2),a("ul",{staticClass:"bottom"},[a("li",{staticClass:"t-r",attrs:{span:6,offset:12}},[e._v("更新日期 : "+e._s(e.headerData.updated_at))]),a("li",{staticClass:"t-r",attrs:{span:6}},[e._v("打印日期 : "+e._s(e.headerData.printed_at))])])]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize--}}},[e._v("A-")]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize++}}},[e._v("A+")]),a("el-button",{ref:"daochu",attrs:{type:"primary"},on:{click:e.exports}},[e._v("导出")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#printMe",expression:"'#printMe'"}],ref:"printButton",attrs:{type:"primary"}},[e._v("打印")]),a("el-button",{on:{click:function(t){return e.cancel(!1)}}},[e._v("取消")])],1)])},i=[],l=(a("99af"),a("4160"),a("d81d"),a("13d5"),a("c19f"),a("b64b"),a("d3b7"),a("3ca3"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("159b"),a("ddb0"),a("2b3d"),{name:"Dialog5",props:{centerDialogVisible:{type:Boolean,default:function(){return!1}},detailData:{type:Object,default:function(){return{}}},print:{type:Boolean,default:!1}},computed:{},data:function(){return{fontSize:14,dialogVisible:!1,tableData:[],headerData:{},arr:[{label:"行号",width:"30px",id:"index"},{label:"路线",width:"30px",id:"delivery_route"},{label:"班次",width:"30px",id:"delivery_shifts"},{label:"收货单位",width:"100px",id:"receiving_unit"},{label:"商品全名",width:"16%",id:"product_name"},{label:"代码",width:"50px",id:"product_code"},{label:"跟单员",width:"50px",id:"order_member"},{label:"数量",width:"50px",id:"delivery_number"},{label:"备次",width:"30px",id:"sparetime"},{label:"订单编号",width:"100px",id:"order_serial"},{label:"库位",width:"100px",id:"warehouse_name"},{label:"备注",width:"10%",id:"note"}]}},watch:{centerDialogVisible:function(e){e&&(this.dialogVisible=!0)},detailData:function(e){e&&(this.headerData=this.detailData.data.delivery_schedule,this.tableData=this.detailData.data.delivery_products)},print:function(e){var t=this;e&&(this.dialogVisible=!0,this.$nextTick((function(){t.$refs.printButton.$el.click()})))}},methods:{exports:function(){var e=this,t="用户统计2020-01-10-2020-01-12",a={bookType:"xlsx",bookSST:!0,type:"binary",cellStyles:!0},r=JSON.parse(JSON.stringify(this.tableData)),i=[];r.map((function(t,a){i[a]={},e.arr.map((function(e){i[a][e.label]="index"===e.id?a+1:t[e.id]}))})),this.downloadExl(i,a,t)},saveAs:function(e,t){var a=document.createElement("a");a.download=t||"未命名","msSaveOrOpenBlob"in navigator?window.navigator.msSaveOrOpenBlob(e,"下载的文件名.xlsx"):a.href=URL.createObjectURL(e),a.click(),setTimeout((function(){URL.revokeObjectURL(e)}),100)},downloadExl:function(e,t,a){var r=this,i=e[0];e.unshift({});var l=[];for(var n in i)l.push(n),e[0][n]=n;i=[];var o=e.map((function(e,t){var a=l.map((function(a,i){return Object.assign({},{v:e[a],position:(i>25?r.getCharCol(i):String.fromCharCode(65+i))+(t+2)})}));return a})),c=this.headerData,d=["A","B","C","D","E","F","G","H","I","J","K","L"],s=["日期:",c.delivery_date,"车号:",c.delivery_train,"司机:",c.delivery_member,"跟车:",c.with_member,"配货员:",c.allocate_member,"单号:",c.delivery_serial];o.unshift(s.map((function(e,t){return{v:e||"",position:d[t]+"1"}}))),o.reduce((function(e,t){return e.concat(t)})).forEach((function(e,t){return i[e.position]={v:e.v}}));var u=Object.keys(i);["A","B","C","D","E","F","G","H","I","J","K","L"].map((function(e){i["".concat(e,"2")].s={font:{sz:14,bold:!0,vertAlign:!0},alignment:{vertical:"center",horizontal:"center"},fill:{bgColor:{rgb:"5491ff"},fgColor:{rgb:"5491ff"}}}})),i["!cols"]=[{wpx:50},{wpx:80},{wpx:80},{wpx:130},{wpx:130},{wpx:80},{wpx:80},{wpx:80},{wpx:100},{wpx:100}];var p={SheetNames:["mySheet"],Sheets:{mySheet:Object.assign({},i,{"!ref":u[0]+":"+u[u.length-1]})}},h=new Blob([this.s2ab(XLSX.write(p,{bookType:void 0==t?"xlsx":t.bookType,bookSST:!1,type:"binary"}))],{type:""});this.saveAs(h,"".concat(new Date)+"."+("biff2"==t.bookType?"xls":t.bookType))},getCharCol:function(e){var t="",a=0;while(e>0)a=e%26+1,t=String.fromCharCode(a+64)+t,e=(e-a)/26;return t},s2ab:function(e){if("undefined"!==typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),r=0;r!=e.length;++r)a[r]=255&e.charCodeAt(r);return t}for(var i=new Array(e.length),l=0;l!=e.length;++l)i[l]=255&e.charCodeAt(l);return i},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e),this.dialogVisible=!1}}}),n=l,o=(a("859a"),a("0c7c")),c=Object(o["a"])(n,r,i,!1,null,"7b5010cc",null);t["a"]=c.exports},"120a":function(e,t,a){"use strict";var r=a("2de0"),i=a.n(r);i.a},"18d4":function(e,t,a){"use strict";var r=a("ca81"),i=a.n(r);i.a},"1d2c":function(e,t,a){"use strict";a.r(t);var r,i,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"second p-10 box"},[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-form",{attrs:{"label-position":"left",inline:!0}},[e._l(e.arr,(function(t,r){return a("el-col",{key:t.label+r,attrs:{span:6}},[a("el-form-item",{staticClass:"form-item",attrs:{label:t.label+"："}},[t.type?e._e():a("el-input",{attrs:{placeholder:t.placeholder||"请输入"},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}}),"select"===t.type?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.placeholder||"请选择",multiple:t.multiple,clearable:""},on:{change:function(a){return e.headerChange(t)}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},e._l(t.data,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1):e._e(),"date"===t.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:t.placeholder||"请选择"},on:{change:function(a){return e.headerChange(t)}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}}):e._e()],1)],1)})),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"f-r"},[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.onAdd}},[e._v("新增")])],1)],1)],2)],1)],1),a("div",{staticClass:"pt-10 f-5 table"},[a("el-table",{ref:"secondTable",staticStyle:{width:"100%"},attrs:{data:e.tableData1,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","header-align":"center"}}),a("el-table-column",{attrs:{label:"操作",width:"50",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[a("el-link",{attrs:{underline:!1,type:"danger"},on:{click:function(a){return e.del(t)}}},[e._v("删除")])],1)}}])}),e._l(e.tableHeader,(function(t,r){return a("el-table-column",{key:t.label+r,attrs:{label:t.label,width:t.width,"header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(r){return["date"===t.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"date",placeholder:t.placeholder||"请选择"},on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):"input"===t.type?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):a("div",[e._v(e._s(r.row[t.id]))])]}}],null,!0)})}))],2)],1),a("div",{staticClass:"pt-10 f-2 table"},[a("el-table",{ref:"multipleTable_b",staticStyle:{width:"100%"},attrs:{data:e.tableData2,border:""}},[a("el-table-column",{attrs:{label:"操作",width:"200",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[a("el-link",{attrs:{underline:!1,type:"danger"},on:{click:function(a){return e.delTwo(t)}}},[e._v("删除")]),a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return e.edit(t)}}},[e._v("修改")]),a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return e.go(t)}}},[e._v("详情")]),a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return e.print(t)}}},[e._v("打印")])],1)}}])}),a("el-table-column",{attrs:{label:"配货员",prop:"allocate_member","header-align":"center"}}),a("el-table-column",{attrs:{label:"跟车员",prop:"with_member","header-align":"center"}}),a("el-table-column",{attrs:{label:"派货员",prop:"delivery_member","header-align":"center"}}),a("el-table-column",{attrs:{label:"车号",prop:"delivery_train","header-align":"center"}}),a("el-table-column",{attrs:{label:"派货单数据ID",prop:"delivery_good_id","header-align":"center"}}),a("el-table-column",{attrs:{label:"更新时间",prop:"updated_at","header-align":"center"}}),a("el-table-column",{attrs:{label:"备注",prop:"note","header-align":"center"}})],1)],1),a("div",{staticClass:"mr-10",staticStyle:{position:"relative"}},[a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.paginate_meta2.total_count,"current-page":e.currentPage2},on:{"update:currentPage":function(t){e.currentPage2=t},"update:current-page":function(t){e.currentPage2=t},"current-change":e.currentChange2}}),a("i",{staticClass:"el-icon-refresh refresh",on:{click:e.queryTwo}})],1),a("Dialog",{attrs:{centerDialogVisible:e.centerDialogVisible,checkArrOk:e.checkArrOk,editData:e.editData},on:{cancel:e.cancel}}),a("Detail",{ref:"printMe",attrs:{print:e.isPrint,centerDialogVisible:e.centerDialogVisible1,detailData:e.detailData},on:{cancel:e.cancel}})],1)},n=[],o=(a("caad"),a("d81d"),a("a9e3"),a("ade3")),c=a("5530"),d=(a("96cf"),a("1da1")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:e.editData.id?"修改工作计划":"新增工作计划",visible:e.dialogVisible,width:"96%",top:"5vh"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.cancel(!1)}}},[a("el-card",{staticClass:"mb-10"},[a("el-row",{attrs:{gutter:20}},[a("el-form",{attrs:{"label-position":"left",inline:!0}},e._l(e.arr,(function(t,r){return a("el-col",{key:t.label+r,attrs:{span:t.span||6}},[a("el-form-item",{staticClass:"form-item",attrs:{label:t.label+"："}},[t.type?e._e():a("el-input",{attrs:{placeholder:t.placeholder||"请输入"},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}}),"select"===t.type?a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:t.disabled,placeholder:t.placeholder||"请选择",filterable:""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},e._l(t.data,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1):e._e()],1)],1)})),1)],1)],1),e.editData.id?a("el-button",{staticClass:"f-r mb-10",attrs:{type:"primary"},on:{click:e.add}},[e._v("追加")]):e._e(),a("div",{staticClass:"pt-10 "},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"500"}},[a("el-table-column",{attrs:{label:"操作",width:"50",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[a("el-link",{attrs:{underline:!1,type:"danger"},on:{click:function(a){return e.del(t)}}},[e._v("删除")])],1)}}])}),e._l(e.tableHeader,(function(t,r){return a("el-table-column",{key:t.label+r,attrs:{label:t.label,width:t.width,"header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(r){return["date"===t.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"date",placeholder:t.placeholder||"请选择"},on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):"input"===t.type?a("el-input",{on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):a("div",[e._v(e._s(r.row[t.id]))])]}}],null,!0)})}))],2)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),a("el-button",{on:{click:function(t){return e.cancel(!1)}}},[e._v("取消")])],1),a("AddProduct",{on:{goBack:e.setTableData}})],1)},u=[],p=(a("a434"),a("2909")),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:"选择产品",visible:e.dialogVisible,width:"85%","append-to-body":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"second"},[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-form",{attrs:{"label-position":"left",inline:!0}},[e._l(e.arr,(function(t,r){return a("el-col",{key:t.label+r,attrs:{span:6}},[a("el-form-item",{staticClass:"form-item",attrs:{label:t.label+"："}},[t.type?e._e():a("el-input",{attrs:{placeholder:t.placeholder||"请输入"},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}}),"select"===t.type?a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:t.placeholder||"请选择",multiple:t.multiple,clearable:""},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}},e._l(t.data,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1):e._e(),"date"===t.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:t.placeholder||"请选择"},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"item.model"}}):e._e()],1)],1)})),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"f-r"},[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1)],1)],2)],1)],1),a("div",{staticClass:"pt-10 "},[a("el-table",{ref:"secondTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"400"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","header-align":"center"}}),e._l(e.tableHeader,(function(t,r){return a("el-table-column",{key:t.label+r,attrs:{label:t.label,width:t.width,"header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(r){return["date"===t.type?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"date",placeholder:t.placeholder||"请选择"},on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):"input"===t.type?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],on:{change:function(a){return e.tableChange(r.row,t)}},model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):a("div",[e._v(e._s(r.row[t.id]))])]}}],null,!0)})}))],2)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.goBack}},[e._v("确 定")])],1)])},b=[],m=(r={name:"AddProduct",props:{},data:function(){return{dialogVisible:!1,arr:[{label:"日期",model:"",placeholder:"",id:"delivery_date",type:"date",data:[]},{label:"班次",model:"",placeholder:"",id:"delivery_shifts",type:"select",data:[]},{label:"路线",model:"",placeholder:"请输入路线",id:"delivery_route",type:"select",data:[],multiple:!0}],tableData:[],checkArr:[]}},watch:{},computed:{}},Object(o["a"])(r,"computed",{tableHeader:function(){return this.$common.tableHeader}}),Object(o["a"])(r,"methods",{handleSelectionChange:function(e){this.checkArr=e},goBack:function(){this.dialogVisible=!1,this.$emit("goBack",this.checkArr),this.checkArr=[]},tableChange:function(e,t){"date"===t.type&&(e[t.id]=this.$common.format(e[t.id]));var a=["delivery_number","sparetime_percent"];a.includes(t.id)&&("delivery_number"===t.id?e[t.id]=parseInt(e[t.id])||0:e[t.id]=Number(e[t.id])||0,e.sparetime=Math.ceil(parseInt(e.delivery_number)*Number(e.sparetime_percent)/100)||0)},query:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(c["a"])(Object(c["a"])({},e.$common.querySql.call(e,e.arr)),{not_paginate:1}),t.next=3,e.$post("/delivery_plans/list_plan",a).then((function(t){var a=t.data.data;a.map((function(e){parseInt(e.delivery_number)||Number(e.sparetime_percent)?e.sparetime=Math.ceil(parseInt(e.delivery_number)*Number(e.sparetime_percent)/100):e.sparetime=0})),e.tableData=a}));case 3:case"end":return t.stop()}}),t)})))()}}),Object(o["a"])(r,"beforeDestroy",(function(){this.$bus.$off("addProduct"),this.$bus.$off("user")})),Object(o["a"])(r,"mounted",(function(){var e=this;this.arr[1].data=this.$vuexData.x.delivery_shift,this.arr[2].data=this.$vuexData.x.delivery_route,this.$bus.$on("user",(function(){e.arr[1].data=e.$vuexData.x.delivery_shift,e.arr[2].data=e.$vuexData.x.delivery_route})),this.$bus.$on("addProduct",(function(t){e.tableData=t.tableData,e.dialogVisible=!0}))})),r),f=m,v=(a("120a"),a("0c7c")),y=Object(v["a"])(f,h,b,!1,null,"1e25f852",null),_=y.exports,g={name:"DeliverGoodsDialog4",props:{centerDialogVisible:{type:Boolean,default:function(){return!1}},checkArrOk:{type:Array,default:function(){return[]}},editData:{type:Object,default:function(){return{}}}},components:{AddProduct:_},computed:{tableHeader:function(){return this.$common.tableHeader}},data:function(){return{dialogVisible:!1,currentPage1:1,total:1,tableData:[],arr:[{label:"单号",model:"",placeholder:"",id:"delivery_shifts",type:"select",disabled:!0,data:[]},{label:"车号",model:"",placeholder:"",id:"delivery_train",type:"select",data:[]},{label:"派货员",model:"",placeholder:"",id:"delivery_member_id",type:"select",data:[]},{label:"跟车员",model:"",placeholder:"",id:"with_member_id",type:"select",data:[]},{label:"配货员",model:"",placeholder:"",id:"allocate_member_id",type:"select",data:[]},{label:"备注说明",model:"",placeholder:"",id:"note",span:18}],selectChangeData:[]}},watch:{centerDialogVisible:function(e){var t=this;e&&(this.dialogVisible=!0,this.arr.map((function(e,a){e.model=t.editData.data[e.id],2===a&&(e.model=t.editData.data.delivery_member),3===a&&(e.model=t.editData.data.with_member),4===a&&(e.model=t.editData.data.allocate_member)})))},checkArrOk:{handler:function(e){var t=this;this.tableData=[],e.map((function(e,a){t.$set(t.tableData,a,e)}))},immediate:!0}},mounted:function(){var e=this,t=this.$vuexData.x;this.arr[1].data=t.delivery_train,this.arr[2].data=t.delivery_member,this.arr[3].data=t.with_member,this.arr[4].data=t.allocate_member,this.$bus.$on("user",(function(){var t=e.$vuexData.x;e.arr[1].data=t.delivery_train,e.arr[2].data=t.delivery_member,e.arr[3].data=t.with_member,e.arr[4].data=t.allocate_member}))},methods:{setTableData:function(e){var t;(t=this.tableData).push.apply(t,Object(p["a"])(e))},add:function(){this.$bus.$emit("addProduct",{tableData:this.editData.tableData})},tableChange:function(e,t){"date"===t.type&&(e[t.id]=this.$common.format(e[t.id]));var a=["delivery_number","sparetime_percent"];a.includes(t.id)&&("delivery_number"===t.id?e[t.id]=parseInt(e[t.id])||0:e[t.id]=Number(e[t.id])||0,e.sparetime=Math.ceil(parseInt(e.delivery_number)*Number(e.sparetime_percent)/100)||0)},del:function(e){var t=0;this.tableData.map((function(a,r){a.delivery_product_id===e.row.delivery_product_id&&(t=r)})),this.tableData.splice(t,1)},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e),this.dialogVisible=!1},save:function(){var e=this,t={};this.arr.map((function(e){e.model&&!e.noHttp&&(t[e.id]=e.model)})),t.delivery_good_id=this.editData.id,t.delivery_products=this.tableData,this.$post("/delivery_plans/".concat(this.editData.id?"for_update":"batch_create_schedule"),t).then((function(t){e.$notify({title:"提示",message:e.editData.id?"修改工作计划成功!":"新增工作计划成功!",type:"success"}),e.cancel(!0)}))},handleSelectionChange:function(e){this.selectChangeData=e}}},w=g,k=Object(v["a"])(w,s,u,!1,null,"9f42030c",null),D=k.exports,x=a("08aa"),$=(i={name:"DeliverGoods",props:{},components:{Dialog:D,Detail:x["a"]},data:function(){return{editData:{},detailData:{},centerDialogVisible:!1,centerDialogVisible1:!1,paginate_meta2:{},arr:[{label:"日期",model:"",placeholder:"",id:"delivery_date",type:"date",data:[]},{label:"班次",model:"",placeholder:"",id:"delivery_shifts",type:"select",data:[]},{label:"路线",model:"",placeholder:"请输入路线",id:"delivery_route",type:"select",data:[],multiple:!0}],tableData1:[],tableData2:[],currentPage2:1,checkArr:[],checkArrOk:[],isPrint:!1}},watch:{},computed:{}},Object(o["a"])(i,"computed",{tableHeader:function(){return this.$common.tableHeader}}),Object(o["a"])(i,"methods",{headerChange:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("delivery_route"!==e.id){a.next=2;break}return a.abrupt("return");case 2:if(t.arr[0].model&&(t.arr[0].model=t.$common.format(t.arr[0].model)),!t.arr[0].model||!t.arr[1].model){a.next=9;break}return a.next=6,t.$post("/delivery_plans/get_routes",{delivery_date:t.arr[0].model,delivery_shifts:t.arr[1].model});case 6:r=a.sent,t.arr[2].data=r.data.data.delivery_route_options,t.arr[2].model="";case 9:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.checkArr=e},edit:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$post("/delivery_plans/detail",{delivery_good_id:e.row.delivery_good_id}).then((function(a){t.checkArrOk=a.data.data.delivery_products,t.editData={id:e.row.delivery_good_id,data:a.data.data.delivery_schedule,tableData:t.tableData1},t.centerDialogVisible=!0}));case 1:case"end":return a.stop()}}),a)})))()},del:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$common.del.call(t,e);case 2:r=a.sent,i=t,r&&setTimeout((function(){i.query(),i.Update()}),300);case 5:case"end":return a.stop()}}),a)})))()},delTwo:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确定删除么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$post("/delivery_plans/delete_schedule",{delivery_good_id:e.row.delivery_good_id||0}).then((function(){t.$message({type:"success",message:"删除成功!"});var e=t;setTimeout((function(){e.queryTwo()}),300)}))}));case 2:a.sent;case 3:case"end":return a.stop()}}),a)})))()},tableChange:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.$common.tableChange.call(a,e,t);case 2:if(["delivery_shifts","delivery_route"].includes(t.id)){r.next=4;break}return r.abrupt("return");case 4:a.Update();case 5:case"end":return r.stop()}}),r)})))()},onAdd:function(){var e=this.checkArr;e.length?(this.centerDialogVisible=!0,this.checkArrOk=JSON.parse(JSON.stringify(e))):this.$notify({title:"警告",message:"最少选择一条产品数据!",type:"warning"})},cancel:function(e){this.centerDialogVisible=!1,this.centerDialogVisible1=!1,this.isPrint=!1,e&&(this.checkArr=[],this.checkArrOk=[],this.currentPage2=1,this.query(),this.queryTwo(),this.Update())},currentChange2:function(e){this.currentPage2=e,this.queryTwo()},query:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(c["a"])(Object(c["a"])({},e.$common.querySql.call(e,e.arr)),{not_paginate:1}),t.next=3,e.$post("/delivery_plans/list_plan",a).then((function(t){var a=t.data.data;a.map((function(e){parseInt(e.delivery_number)||Number(e.sparetime_percent)?e.sparetime=Math.ceil(parseInt(e.delivery_number)*Number(e.sparetime_percent)/100):e.sparetime=0})),e.tableData1=[],e.$nextTick((function(){e.tableData1=a}))}));case 3:case"end":return t.stop()}}),t)})))()},queryTwo:function(){var e=this,t={page:this.currentPage2};this.$post("/delivery_plans/list_schedule",t).then((function(t){var a=t.data.data;e.tableData2=a,e.paginate_meta2=t.data.paginate_meta}))},go:function(e){var t=this;this.$post("/delivery_plans/detail",{delivery_good_id:e.row.delivery_good_id}).then((function(e){t.detailData=e.data,t.centerDialogVisible1=!0}))},print:function(e){var t=this;this.$post("/delivery_plans/detail",{delivery_good_id:e.row.delivery_good_id}).then((function(e){t.detailData=e.data,t.centerDialogVisible1=!0,t.isPrint=!0}))},Update:function(){this.headerChange(this.arr[0])},init:function(){this.arr[1].data=this.$vuexData.x.delivery_shift,this.arr[2].data=this.$vuexData.x.delivery_route}}),Object(o["a"])(i,"mounted",(function(){var e=this;this.init(),this.$bus.$on("user",(function(){e.init()})),this.currentPage2=1,this.query(),this.queryTwo()})),i),C=$,S=(a("18d4"),Object(v["a"])(C,l,n,!1,null,"d265c92c",null));t["default"]=S.exports},"2de0":function(e,t,a){},"859a":function(e,t,a){"use strict";var r=a("f1b0"),i=a.n(r);i.a},a434:function(e,t,a){"use strict";var r=a("23e7"),i=a("23cb"),l=a("a691"),n=a("50c4"),o=a("7b0b"),c=a("65f0"),d=a("8418"),s=a("1dde"),u=a("ae40"),p=s("splice"),h=u("splice",{ACCESSORS:!0,0:0,1:2}),b=Math.max,m=Math.min,f=9007199254740991,v="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!p||!h},{splice:function(e,t){var a,r,s,u,p,h,y=o(this),_=n(y.length),g=i(e,_),w=arguments.length;if(0===w?a=r=0:1===w?(a=0,r=_-g):(a=w-2,r=m(b(l(t),0),_-g)),_+a-r>f)throw TypeError(v);for(s=c(y,r),u=0;u<r;u++)p=g+u,p in y&&d(s,u,y[p]);if(s.length=r,a<r){for(u=g;u<_-r;u++)p=u+r,h=u+a,p in y?y[h]=y[p]:delete y[h];for(u=_;u>_-r+a;u--)delete y[u-1]}else if(a>r)for(u=_-r;u>g;u--)p=u+r-1,h=u+a-1,p in y?y[h]=y[p]:delete y[h];for(u=0;u<a;u++)y[u+g]=arguments[u+2];return y.length=_-r+a,s}})},ca81:function(e,t,a){},f1b0:function(e,t,a){}}]);