(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DeliveryList"],{"08aa":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:"",visible:e.dialogVisible,width:"96%",top:"10vh"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.cancel(!1)}}},[a("div",{ref:"printMe",style:{fontSize:e.fontSize+"px"},attrs:{id:"printMe"}},[a("ul",{staticClass:"top"},[a("li",[e._v("日期 : "+e._s(e.headerData.delivery_date))]),a("li",[e._v("车号 : "+e._s(e.headerData.delivery_train))]),a("li",[e._v("司机 : "+e._s(e.headerData.delivery_member))]),a("li",[e._v("跟车 : "+e._s(e.headerData.with_member))]),a("li",[e._v("配货员 : "+e._s(e.headerData.allocate_member))]),a("li",[e._v("单号 : "+e._s(e.headerData.delivery_serial))])]),a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[a("tr",{staticStyle:{"background-color":"#5491ff"}},e._l(e.arr,(function(t){return a("td",{key:t.label,style:{width:t.width}},[e._v(e._s(t.label))])})),0),e._l(e.tableData,(function(t,i){return[i>0&&e.tableData[i-1].receiving_unit!==e.tableData[i].receiving_unit?a("tr",{key:t.product_name+i,staticStyle:{height:"10px"}}):e._e(),a("tr",{key:t.receiving_unit+i},e._l(e.arr,(function(r){return a("td",{key:r.id},[e._v(e._s("index"!==r.id?t[r.id]:i+1))])})),0)]}))],2),a("ul",{staticClass:"bottom"},[a("li",{staticClass:"t-r",attrs:{span:6,offset:12}},[e._v("更新日期 : "+e._s(e.headerData.updated_at))]),a("li",{staticClass:"t-r",attrs:{span:6}},[e._v("打印日期 : "+e._s(e.headerData.printed_at))])])]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize--}}},[e._v("A-")]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize++}}},[e._v("A+")]),a("el-button",{ref:"daochu",attrs:{type:"primary"},on:{click:e.exports}},[e._v("导出")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#printMe",expression:"'#printMe'"}],ref:"printButton",attrs:{type:"primary"}},[e._v("打印")]),a("el-button",{on:{click:function(t){return e.cancel(!1)}}},[e._v("取消")])],1)])},r=[],n=(a("99af"),a("4160"),a("d81d"),a("13d5"),a("c19f"),a("b64b"),a("d3b7"),a("3ca3"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("159b"),a("ddb0"),a("2b3d"),{name:"Dialog5",props:{centerDialogVisible:{type:Boolean,default:function(){return!1}},detailData:{type:Object,default:function(){return{}}},print:{type:Boolean,default:!1}},computed:{},data:function(){return{fontSize:14,dialogVisible:!1,tableData:[],headerData:{},arr:[{label:"行号",width:"30px",id:"index"},{label:"路线",width:"30px",id:"delivery_route"},{label:"班次",width:"30px",id:"delivery_shifts"},{label:"收货单位",width:"100px",id:"receiving_unit"},{label:"商品全名",width:"16%",id:"product_name"},{label:"代码",width:"50px",id:"product_code"},{label:"跟单员",width:"50px",id:"order_member"},{label:"数量",width:"50px",id:"delivery_number"},{label:"备次",width:"30px",id:"sparetime"},{label:"订单编号",width:"100px",id:"order_serial"},{label:"库位",width:"100px",id:"warehouse_name"},{label:"备注",width:"10%",id:"note"}]}},watch:{centerDialogVisible:function(e){e&&(this.dialogVisible=!0)},detailData:function(e){e&&(this.headerData=this.detailData.data.delivery_schedule,this.tableData=this.detailData.data.delivery_products)},print:function(e){var t=this;e&&(this.dialogVisible=!0,this.$nextTick((function(){t.$refs.printButton.$el.click()})))}},methods:{exports:function(){var e=this,t="用户统计2020-01-10-2020-01-12",a={bookType:"xlsx",bookSST:!0,type:"binary",cellStyles:!0},i=JSON.parse(JSON.stringify(this.tableData)),r=[];i.map((function(t,a){r[a]={},e.arr.map((function(e){r[a][e.label]="index"===e.id?a+1:t[e.id]}))})),this.downloadExl(r,a,t)},saveAs:function(e,t){var a=document.createElement("a");a.download=t||"未命名","msSaveOrOpenBlob"in navigator?window.navigator.msSaveOrOpenBlob(e,"下载的文件名.xlsx"):a.href=URL.createObjectURL(e),a.click(),setTimeout((function(){URL.revokeObjectURL(e)}),100)},downloadExl:function(e,t,a){var i=this,r=e[0];e.unshift({});var n=[];for(var l in r)n.push(l),e[0][l]=l;r=[];var o=e.map((function(e,t){var a=n.map((function(a,r){return Object.assign({},{v:e[a],position:(r>25?i.getCharCol(r):String.fromCharCode(65+r))+(t+2)})}));return a})),c=this.headerData,s=["A","B","C","D","E","F","G","H","I","J","K","L"],d=["日期:",c.delivery_date,"车号:",c.delivery_train,"司机:",c.delivery_member,"跟车:",c.with_member,"配货员:",c.allocate_member,"单号:",c.delivery_serial];o.unshift(d.map((function(e,t){return{v:e||"",position:s[t]+"1"}}))),o.reduce((function(e,t){return e.concat(t)})).forEach((function(e,t){return r[e.position]={v:e.v}}));var u=Object.keys(r);["A","B","C","D","E","F","G","H","I","J","K","L"].map((function(e){r["".concat(e,"2")].s={font:{sz:14,bold:!0,vertAlign:!0},alignment:{vertical:"center",horizontal:"center"},fill:{bgColor:{rgb:"5491ff"},fgColor:{rgb:"5491ff"}}}})),r["!cols"]=[{wpx:50},{wpx:80},{wpx:80},{wpx:130},{wpx:130},{wpx:80},{wpx:80},{wpx:80},{wpx:100},{wpx:100}];var p={SheetNames:["mySheet"],Sheets:{mySheet:Object.assign({},r,{"!ref":u[0]+":"+u[u.length-1]})}},b=new Blob([this.s2ab(XLSX.write(p,{bookType:void 0==t?"xlsx":t.bookType,bookSST:!1,type:"binary"}))],{type:""});this.saveAs(b,"".concat(new Date)+"."+("biff2"==t.bookType?"xls":t.bookType))},getCharCol:function(e){var t="",a=0;while(e>0)a=e%26+1,t=String.fromCharCode(a+64)+t,e=(e-a)/26;return t},s2ab:function(e){if("undefined"!==typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),i=0;i!=e.length;++i)a[i]=255&e.charCodeAt(i);return t}for(var r=new Array(e.length),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return r},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e),this.dialogVisible=!1}}}),l=n,o=(a("859a"),a("0c7c")),c=Object(o["a"])(l,i,r,!1,null,"7b5010cc",null);t["a"]=c.exports},"859a":function(e,t,a){"use strict";var i=a("f1b0"),r=a.n(i);r.a},d7ea:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"second box"},[i("el-card",{staticClass:"p-10"},[i("el-row",{attrs:{gutter:20}},[i("el-form",{attrs:{"label-position":"left",inline:!0}},[t._l(t.arr,(function(e,a){return i("el-col",{key:e.label+a,attrs:{span:6}},[i("el-form-item",{staticClass:"form-item",attrs:{label:e.label}},[e.type?t._e():i("el-input",{attrs:{placeholder:e.placeholder||"请输入"},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"item.model"}}),"select"===e.type?i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:e.placeholder||"请选择",clearable:""},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"item.model"}},t._l(e.data,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1):t._e()],1)],1)})),i("el-col",{attrs:{span:6}},[i("el-form-item",{staticClass:"f-r"},[i("el-button",{attrs:{type:"primary"},on:{click:function(){e.currentPage=1,e.query()}}},[t._v("查询")])],1)],1)],2)],1)],1),i("div",{staticClass:"pt-10 table"},[i("el-table",{ref:"multipleTable_b",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[i("el-table-column",{attrs:{label:"操作",width:"170",align:"center","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[i("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return t.edit(e)}}},[t._v("修改状态")]),i("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return t.go(e)}}},[t._v("详情")])],1)}}])}),i("el-table-column",{attrs:{label:"配货员",prop:"allocate_member","header-align":"center"}}),i("el-table-column",{attrs:{label:"跟车员",prop:"with_member","header-align":"center"}}),i("el-table-column",{attrs:{label:"派货员",prop:"delivery_member","header-align":"center"}}),i("el-table-column",{attrs:{label:"车号",prop:"delivery_train","header-align":"center"}}),i("el-table-column",{attrs:{label:"派货单数据ID",prop:"delivery_good_id","header-align":"center"}}),i("el-table-column",{attrs:{label:"状态",prop:"status_name","header-align":"center"}}),i("el-table-column",{attrs:{label:"更新时间",prop:"updated_at","header-align":"center"}}),i("el-table-column",{attrs:{label:"备注",prop:"note","header-align":"center"}})],1)],1),i("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:t.paginate_meta.total_count,"current-page":t.currentPage},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.currentChange}}),i("Detail",{attrs:{centerDialogVisible:t.centerDialogVisible,detailData:t.detailData},on:{cancel:t.cancel}})],1)},r=[],n=a("5530"),l=(a("96cf"),a("1da1")),o=a("08aa"),c={name:"DeliveryList",props:{activeName:{type:String,default:"third"},user:{type:Array,default:function(){return[]}}},components:{Detail:o["a"]},data:function(){return{arr:[{label:"下单客户：",model:"",placeholder:"",type:"select",data:[],id:"customer_id"},{label:"收货单位：",model:"",placeholder:"",data:[],id:"receiving_unit"},{label:"产品名称：",model:"",placeholder:"",id:"product_name"}],detailData:{},centerDialogVisible:!1,paginate_meta:{},tableData:[],currentPage:1}},watch:{},computed:{},mounted:function(){var e=this;this.arr[0].data=this.$vuexData.x.customer,this.$bus.$on("user",(function(){e.arr[0].data=e.$vuexData.x.customer})),this.query()},methods:{cancel:function(e){this.centerDialogVisible=!1,e&&(this.currentPage=1,this.query())},edit:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$confirm("确定修改状态么?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$post("/delivery_plans/switch_status",{delivery_good_id:e.row.delivery_good_id||0}).then((function(){t.$message({type:"success",message:"更改状态成功!"});var e=t;setTimeout((function(){e.query()}),300)}))}));case 2:case"end":return a.stop()}}),a)})))()},currentChange:function(e){this.currentPage=e,this.query()},query:function(){var e=this,t=Object(n["a"])(Object(n["a"])({},this.$common.querySql.call(this,this.arr)),{page:this.currentPage});this.$post("/delivery_plans/list_schedule",t).then((function(t){var a=t.data.data;e.tableData=a,e.paginate_meta=t.data.paginate_meta}))},go:function(e){var t=this;this.$post("/delivery_plans/detail",{delivery_good_id:e.row.delivery_good_id}).then((function(e){t.detailData=e.data})),this.centerDialogVisible=!0}}},s=c,d=a("0c7c"),u=Object(d["a"])(s,i,r,!1,null,"6a5b1cef",null);t["default"]=u.exports},f1b0:function(e,t,a){}}]);