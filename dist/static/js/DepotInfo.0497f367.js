(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DepotInfo"],{1148:function(e,t,a){"use strict";var i=a("a691"),r=a("1d80");e.exports="".repeat||function(e){var t=String(r(this)),a="",n=i(e);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(t+=t))1&n&&(a+=t);return a}},"408a":function(e,t,a){var i=a("c6b6");e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},4489:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p-10 box"},[a("Panel",{attrs:{arr:e.arr}},[a("el-col",{staticClass:"d-f-e",attrs:{span:10}},[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1)],1),a("div",{staticClass:"pt-10 table"},[a("el-table",{ref:"firstTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},e._l(e.tableHeader,(function(t,i){return a("el-table-column",{key:t.label+i,attrs:{"header-align":"center",label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){return["update"===t.id?a("div",{staticClass:"d-f-s-a"},[a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(t){return e.change(i.row,1)}}},[e._v("分配")]),a("el-link",{attrs:{underline:!1,type:"warning"},on:{click:function(t){return e.change(i.row,2)}}},[e._v("调整")])],1):e._e(),"storage_number"===t.id?["storage_number"===t.id?a("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.detailChange(i.row)}}},[e._v(e._s(i.row[t.id]))]):e._e()]:["input"===t.type?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],model:{value:i.row[t.id],callback:function(a){e.$set(i.row,t.id,a)},expression:"scope.row[item.id]"}}):"serial"===t.type?a("div",{staticClass:"t-c"},[e._v(e._s(i.$index+1))]):a("div",[e._v(e._s(i.row[t.id]))])]]}}],null,!0)})})),1)],1),a("el-pagination",{staticClass:"pagination mr-10",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.total,"page-size":20,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}}),a("el-dialog",{staticClass:"dialog box",attrs:{title:3===e.visibleType?"详情":1===e.visibleType?"分配":"调整",visible:e.visible,width:3===e.visibleType?"70%":"20%",center:"",top:3===e.visibleType?"8vh":"30vh","close-on-click-modal":!1},on:{close:function(t){e.visible=!1}}},[3===e.visibleType?a("div",{staticClass:"table"},[a("el-table",{ref:"firstTable",staticStyle:{width:"100%"},attrs:{data:e.visibleTable,height:"600",border:"",stripe:""}},e._l(e.visibleHeader,(function(t,i){return a("el-table-column",{key:t.label+i,attrs:{"header-align":"center",label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(i){return[["input"===t.type?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],model:{value:i.row[t.id],callback:function(a){e.$set(i.row,t.id,a)},expression:"scope.row[item.id]"}}):"serial"===t.type?a("div",{staticClass:"t-c"},[e._v(e._s(i.$index+1))]):a("div",[e._v(e._s(i.row[t.id]))])]]}}],null,!0)})})),1)],1):[1===e.visibleType?[a("Page",{staticClass:"w-100",attrs:{data:e.$vuexData.x.location,clearable:!0,placeholder:"请选择库位"},model:{value:e.locationModel,callback:function(t){e.locationModel=t},expression:"locationModel"}})]:e._e(),a("el-input",{ref:"input",class:{"pt-10":1===e.visibleType},attrs:{placeholder:"请输入数量！"},on:{change:function(t){e.visibleModel=parseInt(e.visibleModel)||0}},model:{value:e.visibleModel,callback:function(t){e.visibleModel=t},expression:"visibleModel"}})],a("div",{staticClass:"d-f-e pt-10"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),3!==e.visibleType?a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]):e._e()],1)],2)],1)},r=[],n=(a("4de4"),a("d81d"),a("b0c0"),a("b680"),a("d3b7"),a("ddb0"),a("5530")),l=(a("96cf"),a("1da1")),o={name:"depot",data:function(){return{arr:[{label:"客户",model:"",placeholder:"",type:"page",data:[],id:"customer_id"},{label:"销售",model:"",placeholder:"",type:"select",data:[],id:"saler_id"},{label:"跟单",model:"",placeholder:"",type:"select",data:[],id:"member_id"},{label:"分类",model:"",placeholder:"",type:"select",data:[],id:"product_group"},{label:"产品名称",model:"",placeholder:"",id:"product_name"},{label:"入库时间",model:"",placeholder:"",type:"daterange",span:8,id:"delivery_date_min"}],tableData:[],tableHeader:[{label:"操作",id:"update",width:100},{label:"销售",id:"saler_name"},{label:"跟单员",id:"member_name"},{label:"分类",id:"product_group"},{label:"客户名称",id:"customer_name"},{label:"产品名称",id:"product_name"},{label:"单价",id:"product_price"},{label:"数量",id:"storage_number"},{label:"金额",id:"money"},{label:"入库日期",id:"updated_at"},{label:"仓储库位",id:"location_name"}],visibleHeader:[{label:"序号",type:"serial",width:50},{label:"变更时间",id:"created_at"},{label:"变更类型",id:"history_source"},{label:"变更数量",id:"number_switch"},{label:"单价",id:"product_price"},{label:"操作人",id:"created_by"},{label:"变更后库存",id:"number_current"}],currentPage:1,total:1,visible:!1,visibleType:1,visibleModel:null,visibleData:{},locationModel:null,visibleTable:[]}},methods:{query:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(n["a"])(Object(n["a"])({},e.$common.querySql.call(e,e.arr)),{page:e.currentPage}),a.delivery_date_min&&(a.created_at_max=moment(a.delivery_date_min[1]).format("YYYY-MM-DD"),a.created_at_min=moment(a.delivery_date_min[0]).format("YYYY-MM-DD")),a.customer_id&&(a.customer_id=e.$vuexData.x.customer.filter((function(e){return e.id===a.customer_id}))[0].name),t.next=5,e.$post("yuanyi_storages/list",a);case 5:i=t.sent,e.tableData=i.data.data.entries.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{money:(e.product_price*e.storage_number).toFixed(2)})})),e.total=i.data.data.paginate_meta.total_count;case 8:case"end":return t.stop()}}),t)})))()},currentChange:function(e){this.currentPage=e,this.query()},save:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.visibleModel){t.next=3;break}return e.$notify({title:"错误",message:"数量不能为空！",type:"warning"}),t.abrupt("return");case 3:return a={storage_id:e.visibleData.id,storage_number:e.visibleModel},1===e.visibleType&&(a.location_id=e.locationModel),t.next=7,e.$post("yuanyi_storages/".concat(1===e.visibleType?"switch_location":"change_storage"),a);case 7:t.sent,e.$common.notify(1===e.visibleType?"分配":"调整"),e.query(),e.visible=!1,e.visibleModel=null;case 12:case"end":return t.stop()}}),t)})))()},change:function(e,t){var a=this;this.visible=!0,this.visibleType=t,this.visibleData=e,this.locationModel=this.$vuexData.x.location[0].id,this.$nextTick((function(){a.$refs.input.focus()}))},detailChange:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.visible=!0,t.visibleType=3,a.next=4,t.$post("yuanyi_storages/for_show",{storage_id:e.id});case 4:i=a.sent,t.visibleTable=i.data.data.histories,console.log(i);case 7:case"end":return a.stop()}}),a)})))()}},mounted:function(){var e=this;this.query(),this.arr[0].data=this.$vuexData.x.customer,this.arr[3].data=this.$vuexData.x.group_options,this.arr[1].data=this.$vuexData.x.member_options,this.arr[2].data=this.$vuexData.x.member_options,this.$bus.$on("user",(function(){e.arr[0].data=e.$vuexData.x.customer,e.arr[3].data=e.$vuexData.x.group_options,e.arr[1].data=e.$vuexData.x.member_options,e.arr[2].data=e.$vuexData.x.member_options}))}},s=o,c=a("0c7c"),d=Object(c["a"])(s,i,r,!1,null,"02bec329",null);t["default"]=d.exports},b680:function(e,t,a){"use strict";var i=a("23e7"),r=a("a691"),n=a("408a"),l=a("1148"),o=a("d039"),s=1..toFixed,c=Math.floor,d=function(e,t,a){return 0===t?a:t%2===1?d(e,t-1,a*e):d(e*e,t/2,a)},u=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},b=s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){s.call({})}));i({target:"Number",proto:!0,forced:b},{toFixed:function(e){var t,a,i,o,s=n(this),b=r(e),p=[0,0,0,0,0,0],v="",m="0",f=function(e,t){var a=-1,i=t;while(++a<6)i+=e*p[a],p[a]=i%1e7,i=c(i/1e7)},h=function(e){var t=6,a=0;while(--t>=0)a+=p[t],p[t]=c(a/e),a=a%e*1e7},_=function(){var e=6,t="";while(--e>=0)if(""!==t||0===e||0!==p[e]){var a=String(p[e]);t=""===t?a:t+l.call("0",7-a.length)+a}return t};if(b<0||b>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(v="-",s=-s),s>1e-21)if(t=u(s*d(2,69,1))-69,a=t<0?s*d(2,-t,1):s/d(2,t,1),a*=4503599627370496,t=52-t,t>0){f(0,a),i=b;while(i>=7)f(1e7,0),i-=7;f(d(10,i,1),0),i=t-1;while(i>=23)h(1<<23),i-=23;h(1<<i),f(1,1),h(2),m=_()}else f(0,a),f(1<<-t,0),m=_()+l.call("0",b);return b>0?(o=m.length,m=v+(o<=b?"0."+l.call("0",b-o)+m:m.slice(0,o-b)+"."+m.slice(o-b))):m=v+m,m}})}}]);