(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["EnterDepot"],{"4cca":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p-10 box"},[a("Panel",{attrs:{arr:e.arr}},[a("el-col",{staticClass:"d-f-e",attrs:{span:12}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.query}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.panelChange}},[e._v("新增入库单")])],1)],1),a("div",{staticClass:"pt-10 table"},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{label:"入库日期",align:"center",prop:"entried_at","header-align":"center"}}),a("el-table-column",{attrs:{label:"销售",align:"center",prop:"saler_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"负责人",align:"center",prop:"member_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"分类",align:"center",prop:"product_group","header-align":"center"}}),a("el-table-column",{attrs:{label:"客户名称",align:"center",prop:"customer_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"订单编号",align:"center",prop:"order_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品名称",align:"center",prop:"product_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品编码",align:"center",prop:"product_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"当前库存",align:"center",prop:"ccccc","header-align":"center"}}),a("el-table-column",{attrs:{label:"入库数量",align:"center",prop:"storage_number","header-align":"center"}}),a("el-table-column",{attrs:{label:"库位",align:"center",prop:"location_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"是否结束",align:"center",prop:"note","header-align":"center"}})],1)],1),a("el-pagination",{staticClass:"pagination mr-10",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.total,"page-size":20,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}}),a("el-dialog",{staticClass:"dialog",attrs:{title:"新建入库单",visible:e.visible,width:"95%",top:"5vh","close-on-click-modal":!1},on:{close:function(t){e.visible=!1}}},[a("AddEnterDepot",{on:{cancel:e.cancel}})],1),a("el-dialog",{staticClass:"dialog",attrs:{title:"批量导入",visible:e.visibleBatch,width:"40%",top:"5vh"},on:{close:function(t){e.visibleBatch=!1}}},[e._v(" 默认模板： "),a("div",[e._v("xsjxsjixs.xlsx")]),a("el-upload",{staticClass:" t-c",attrs:{accept:".xlsx,.xls",drag:"",action:"https://jsonplaceholder.typicode.com/posts/"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xlsx,xls文件")])]),a("div",{staticClass:"d-f-e pt-10"},[a("el-button",{on:{click:function(t){e.visibleBatch=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},l=[],r=(a("4de4"),a("b0c0"),a("d3b7"),a("ddb0"),a("5530")),o=(a("96cf"),a("1da1")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticClass:"f-r mb-10",attrs:{type:"warning"},on:{click:function(t){e.visible=!0}}},[e._v("选择入库产品")]),a("div",{staticClass:"pt-10 "},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center","header-align":"center"}}),a("el-table-column",{attrs:{label:"入库日期",align:"center",prop:"entried_at","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-date-picker",{attrs:{type:"date",placeholder:"date"},model:{value:t.row["entried_at"],callback:function(a){e.$set(t.row,"entried_at",a)},expression:"scope.row['entried_at']"}})]}}])}),a("el-table-column",{attrs:{label:"销售",align:"center",prop:"saler_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"负责人",align:"center",prop:"member_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"分类",align:"center",prop:"product_group","header-align":"center"}}),a("el-table-column",{attrs:{label:"客户名称",align:"center",prop:"customer_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"订单编号",align:"center",prop:"order_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品名称",align:"center",prop:"product_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品编码",align:"center",prop:"product_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"当前库存",align:"center",prop:"ccccc","header-align":"center"}}),a("el-table-column",{attrs:{label:"入库数量",align:"center",prop:"entry_number","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:""},on:{change:function(a){return e.numberChange(t.row)}},model:{value:t.row["entry_number"],callback:function(a){e.$set(t.row,"entry_number",a)},expression:"scope.row['entry_number']"}})]}}])}),a("el-table-column",{attrs:{label:"库位",align:"center",prop:"location_id","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"",filterable:""},model:{value:t.row["location_id"],callback:function(a){e.$set(t.row,"location_id",a)},expression:"scope.row['location_id']"}},e._l(e.location_options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}])}),a("el-table-column",{attrs:{label:"是否结束",align:"center",prop:"note","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:""},model:{value:t.row["note"],callback:function(a){e.$set(t.row,"note",a)},expression:"scope.row['note']"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"50",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[a("el-link",{attrs:{underline:!1,type:"danger"},on:{click:function(a){return e.del(t.$index)}}},[e._v("删除")])],1)}}])})],1)],1),a("div",{staticClass:"d-f-e pt-10"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1),a("AddDialogs",{attrs:{visible:e.visible},on:{save:e.addDialogData,cancel:function(t){e.visible=!1}}})],1)},c=[],s=(a("99af"),a("d81d"),a("a434"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:"出入库产品选择",visible:e.dialogVisible,width:"85%",top:"5vh","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.cancel(!1)}}},[a("el-card",{staticClass:"mb-10"},[a("el-row",{attrs:{gutter:20}},[a("el-form",{attrs:{"label-position":"left",inline:!0}},[a("el-col",{attrs:{span:"7"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:"客户名称："}},[a("Page",{attrs:{clearable:!0,placeholder:"请选择客户名称",data:e.$vuexData.x.customer},on:{change:e.custChange},model:{value:e.cust,callback:function(t){e.cust=t},expression:"cust"}})],1)],1),a("el-col",{attrs:{span:"5"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"订单编号/产品名称/产品编号"},model:{value:e.inputModel,callback:function(t){e.inputModel=t},expression:"inputModel"}})],1)],1),a("el-col",{attrs:{span:"12"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:""}},[a("el-button",{staticClass:"f-r ml-10",attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),a("el-button",{staticClass:"f-r",attrs:{type:"warning"},on:{click:e.query}},[e._v("查询")])],1)],1)],1)],1)],1),a("div",{staticClass:"pt-10 "},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"600"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","header-align":"center"}}),a("el-table-column",{attrs:{label:"入库日期",align:"center",prop:"entried_at","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-date-picker",{attrs:{type:"date",placeholder:"date"},model:{value:t.row["entried_at"],callback:function(a){e.$set(t.row,"entried_at",a)},expression:"scope.row['entried_at']"}})]}}])}),a("el-table-column",{attrs:{label:"销售",align:"center",prop:"saler_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"负责人",align:"center",prop:"member_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"分类",align:"center",prop:"product_group","header-align":"center"}}),a("el-table-column",{attrs:{label:"客户名称",align:"center",prop:"customer_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"订单编号",align:"center",prop:"order_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品名称",align:"center",prop:"product_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品编码",align:"center",prop:"product_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"当前库存",align:"center",prop:"ccccc","header-align":"center"}}),a("el-table-column",{attrs:{label:"入库数量",align:"center",prop:"entry_number","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:""},on:{change:function(a){return e.numberChange(t.row)}},model:{value:t.row["entry_number"],callback:function(a){e.$set(t.row,"entry_number",a)},expression:"scope.row['entry_number']"}})]}}])}),a("el-table-column",{attrs:{label:"库位",align:"center",prop:"location_id","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Page",{attrs:{clearable:!0,placeholder:"",data:e.location_options},model:{value:t.row["location_id"],callback:function(a){e.$set(t.row,"location_id",a)},expression:"scope.row['location_id']"}})]}}])}),a("el-table-column",{attrs:{label:"是否结束",align:"center",prop:"note","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{placeholder:""},model:{value:t.row["note"],callback:function(a){e.$set(t.row,"note",a)},expression:"scope.row['note']"}})]}}])})],1),a("el-pagination",{staticClass:"pt-10 d-f-e",attrs:{layout:"prev, pager, next","current-page":e.currentPage,total:e.total_count,background:"","page-size":20},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}})],1)],1)}),u=[],d=(a("4160"),a("caad"),a("2532"),a("159b"),{name:"AddDialog",props:{visible:{type:Boolean,default:function(){return!1}}},data:function(){return{multipleSelection:[],inputModel:"",cust:null,custData:[],dialogVisible:!1,tableData:[],location_options:[],total_count:1,currentPage:1}},watch:{visible:function(e){e&&(this.dialogVisible=!0,this.multipleSelection=[],this.query())}},methods:{custChange:function(){this.inputModel="",this.query()},numberChange:function(e){e.entry_number=parseInt(e.entry_number)||0},handleSelectionChange:function(e){this.multipleSelection=e},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e),this.dialogVisible=!1},query:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n,l,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={page:e.currentPage,query_key:e.inputModel,customer_id:e.cust},t.next=3,e.$post("yuanyi_entries/choose_products",a);case 3:n=t.sent,n=n.data.data,l=e.multipleSelection,r=n.products.filter((function(t){return!e.multipleSelection.map((function(e){return e.id})).includes(t.id)})),r.map((function(e,t){e.location_id=n.location_options.length?n.location_options[0].id:null,e.entried_at=moment().format("YYYY-MM-DD")})),e.tableData=e.multipleSelection.concat(r),e.$nextTick((function(){l.forEach((function(t){e.$refs.table.toggleRowSelection(t)}))})),e.total_count=n.paginate_meta.total_count,e.location_options=n.location_options;case 12:case"end":return t.stop()}}),t)})))()},save:function(){this.multipleSelection.length?(this.$emit("save",this.multipleSelection,this.location_options),this.cancel()):this.$notify({title:"警告",message:"你未选中任何一条数据，请检查！",type:"warning"})},currentChange:function(){this.query()}},beforeDestroy:function(){},mounted:function(){}}),p=d,b=a("0c7c"),m=Object(b["a"])(p,s,u,!1,null,"5bcbc1d8",null),g=m.exports,h={name:"AddDialog",props:{},data:function(){return{model:"",options:[],tableData:[],visible:!1,location_options:[],date:moment().format("YYYY-MM-DD")}},components:{AddDialogs:g},watch:{},methods:{addDialogData:function(e,t){this.location_options=t,this.tableData=this.tableData.concat(e),this.visible=!1},del:function(e){this.tableData.splice(e,1)},save:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.tableData.length){t.next=3;break}return e.$notify({title:"警告",message:"数据为空,不能保存。请增加数据!",type:"warning"}),t.abrupt("return");case 3:return a={},e.tableData.map((function(e,t){e.entried_at=moment(e.entried_at).format("YYYY-MM-DD"),a[t]=e})),t.next=7,e.$post("yuanyi_entries/for_create",{products:a});case 7:t.sent,e.cancel(!0);case 9:case"end":return t.stop()}}),t)})))()},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tableData=[],this.$emit("cancel",e)},numberChange:function(e){e.entry_number=parseInt(e.entry_number)||0}},beforeDestroy:function(){this.$bus.$off("AddOutDepot")},mounted:function(){this.$bus.$on("AddOutDepot",(function(e){console.log(e)}))}},f=h,_=Object(b["a"])(f,i,c,!1,null,"d2a27f58",null),v=_.exports,y={name:"enterDepot",data:function(){return{visible:!1,visibleBatch:!1,arr:[{label:"仓位",model:"",placeholder:"",type:"page",data:[],id:"location_id"},{label:"客户",model:"",placeholder:"",type:"page",data:[],id:"customer_id"},{label:"销售",model:"",placeholder:"",type:"select",data:[],id:"location_id"},{label:"负责人",model:"",placeholder:"",type:"select",data:[],id:"member_id"},{label:"部门",model:"",placeholder:"",type:"select",data:[],id:"product_group"},{label:"入库时间",model:"",placeholder:"",type:"daterange",span:6,id:"delivery_date_min"}],tableData:[],currentPage:1,total:1}},components:{AddEnterDepot:v},methods:{query:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(r["a"])(Object(r["a"])({},e.$common.querySql.call(e,e.arr)),{page:e.currentPage}),a.delivery_date_min&&(a.created_at_max=moment(a.delivery_date_min[1]).format("YYYY-MM-DD"),a.created_at_min=moment(a.delivery_date_min[0]).format("YYYY-MM-DD")),a.customer_id&&(a.customer_id=e.$vuexData.x.customer.filter((function(e){return e.id===a.customer_id}))[0].name),t.next=5,e.$post("yuanyi_entries/list",a);case 5:n=t.sent,e.tableData=n.data.data.entries,e.total=n.data.data.paginate_meta.total_count;case 8:case"end":return t.stop()}}),t)})))()},panelChange:function(){this.visible=!0},currentChange:function(e){this.currentPage=e,this.query()},init:function(){this.arr[0].data=this.$vuexData.x.location,this.arr[1].data=this.$vuexData.x.customer,this.arr[2].data=this.$vuexData.x.member_options,this.arr[3].data=this.$vuexData.x.member_options,this.arr[4].data=this.$vuexData.x.group_options},cancel:function(e){this.visible=!1,e&&this.query()}},mounted:function(){var e=this;this.query(),this.init(),this.$bus.$on("user",(function(){e.init()}))}},w=y,x=Object(b["a"])(w,n,l,!1,null,"7e2a4993",null);t["default"]=x.exports},a434:function(e,t,a){"use strict";var n=a("23e7"),l=a("23cb"),r=a("a691"),o=a("50c4"),i=a("7b0b"),c=a("65f0"),s=a("8418"),u=a("1dde"),d=a("ae40"),p=u("splice"),b=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,g=Math.min,h=9007199254740991,f="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!b},{splice:function(e,t){var a,n,u,d,p,b,_=i(this),v=o(_.length),y=l(e,v),w=arguments.length;if(0===w?a=n=0:1===w?(a=0,n=v-y):(a=w-2,n=g(m(r(t),0),v-y)),v+a-n>h)throw TypeError(f);for(u=c(_,n),d=0;d<n;d++)p=y+d,p in _&&s(u,d,_[p]);if(u.length=n,a<n){for(d=y;d<v-n;d++)p=d+n,b=d+a,p in _?_[b]=_[p]:delete _[b];for(d=v;d>v-n+a;d--)delete _[d-1]}else if(a>n)for(d=v-n;d>y;d--)p=d+n-1,b=d+a-1,p in _?_[b]=_[p]:delete _[b];for(d=0;d<a;d++)_[d+y]=arguments[d+2];return _.length=v-n+a,u}})}}]);