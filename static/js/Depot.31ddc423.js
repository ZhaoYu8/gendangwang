(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Depot"],{a3d0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"p-10 box"},[a("Panel",{attrs:{arr:e.arr},on:{change:e.panelChange}},[a("el-col",{staticClass:"d-f d-f-c",attrs:{span:6}},[a("div",{staticClass:"el-form-item__label"},[e._v("总出库数：")]),e.total_delivery?a("div",[a("div",[e._v(e._s(e.$common.toThousands(e.total_delivery)))]),a("div",[e._v("大约 "+e._s(e.$common.bigNumTransform(e.total_delivery)))])]):e._e()]),a("el-col",{staticClass:"d-f d-f-c",attrs:{span:6}},[a("div",{staticClass:"el-form-item__label"},[e._v("总出库金额：")]),e.total_price?a("div",[a("div",[e._v(e._s(e.$common.toThousands(e.total_price)))]),a("div",[e._v("大约 "+e._s(e.$common.bigNumTransform(e.total_price)))])]):e._e()]),a("el-col",{staticClass:"d-f-e",attrs:{span:6}},[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")])],1)])],1),a("div",{staticClass:"pt-10 table"},[a("el-table",{ref:"firstTable",staticStyle:{width:"100%"},attrs:{"show-summary":!0,"summary-method":e.getSummaries,data:e.tableData,border:"",stripe:""}},e._l(e.tableHeader,(function(t,r){return a("el-table-column",{key:t.label+r,attrs:{"header-align":"center",label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(r){return["update"===t.id&&1!==r.row.status?a("div",{staticClass:"d-f-s-a"},[a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(t){return e.change(r.row)}}},[e._v("确认")])],1):["input"===t.type?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],model:{value:r.row[t.id],callback:function(a){e.$set(r.row,t.id,a)},expression:"scope.row[item.id]"}}):"serial"===t.type?a("div",{staticClass:"t-c"},[e._v(e._s(r.$index+1))]):a("div",{staticClass:"t-c"},[e._v(e._s(r.row[t.id]))])]]}}],null,!0)})})),1)],1),a("el-pagination",{staticClass:"pagination mr-10",attrs:{background:"",layout:"total, prev, pager, next, jumper",total:e.total,"page-size":20,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}})],1)},n=[],i=(a("4de4"),a("4160"),a("d81d"),a("13d5"),a("b0c0"),a("b680"),a("159b"),a("5530")),l=(a("96cf"),a("1da1")),o={name:"depot",data:function(){return{total_delivery:0,total_price:0,arr:[{label:"客户",model:"",placeholder:"",type:"page",data:[],id:"customer_id"},{label:"销售",model:"",placeholder:"",type:"select",data:[],id:"saler_id"},{label:"跟单",model:"",placeholder:"",type:"select",data:[],id:"member_id"},{label:"分类",model:"",placeholder:"",type:"select",data:[],id:"confirm_type"},{label:"产品名称",model:"",placeholder:"",id:"product_name"},{label:"入库时间",model:"",placeholder:"",span:6,type:"daterange",id:"delivery_date_min"},{label:"收货人",model:"",placeholder:"",type:"page",data:[],id:"contact_name"},{label:"收货单位",model:"",placeholder:"",type:"page",data:[],id:"contact_company"},{label:"筛选内容",model:1,placeholder:"",type:"filter",span:6,id:"confirm_status",data:[{name:"全部",id:0},{name:"待确认",id:1},{name:"已确认",id:2}]}],tableData:[],tableHeader:[{label:"操作",id:"update",width:60},{label:"确认状态",id:"status_name",width:80},{label:"出库时间",id:"created_at",width:150},{label:"出库类型",id:"confirm_type"},{label:"销售",id:"saler_name"},{label:"负责人",id:"member_name"},{label:"客户名称",id:"customer_name",width:"240"},{label:"收货人",id:"contact_name"},{label:"收货单位",id:"contact_company"},{label:"订单编号",id:"order_serial"},{label:"产品名称",id:"product_name",width:"240"},{label:"产品编码",id:"product_serial"},{label:"出库数量",id:"delivery_number"},{label:"单价",id:"product_price"},{label:"库位",id:"location_name"}],currentPage:1,total:1}},computed:{num:function(){return this.tableData.map((function(e){return e.delivery_number})).reduce((function(e,t){return e+t}))},money:function(){return this.tableData.map((function(e){return e.delivery_number*e.product_price})).reduce((function(e,t){return e+t})).toFixed(2)}},methods:{panelChange:function(e){"confirm_status"===e.id&&this.query()},getSummaries:function(e){var t=this,a=e.columns,r=(e.data,[]);return this.tableData.length&&a.forEach((function(e,a){0!==a?"出库数量"===e.label?r[a]=t.num:"单价"===e.label?r[a]=t.money:r[a]="":r[a]="合计:"})),r},query:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Object(i["a"])(Object(i["a"])({},e.$common.querySql.call(e,e.arr)),{page:e.currentPage}),a.delivery_date_min&&(a.created_at_max=moment(a.delivery_date_min[1]).format("YYYY-MM-DD"),a.created_at_min=moment(a.delivery_date_min[0]).format("YYYY-MM-DD")),a.customer_id&&(a.customer_id=e.$vuexData.x.customer.filter((function(e){return e.id===a.customer_id}))[0].name),0===a.confirm_status&&delete a.confirm_status,t.next=6,e.$post("/yuanyi_deliveries/list",a);case 6:r=t.sent,n=r.data,e.tableData=n.data.items.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{money:(e.product_price*e.storage_number).toFixed(2)})})),e.total=n.data.paginate_meta.total_count,e.total_delivery=n.data.total_delivery,e.total_price=n.data.total_price;case 12:case"end":return t.stop()}}),t)})))()},currentChange:function(e){this.currentPage=e,this.query()},change:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.$prompt("是否确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",inputValue:e.delivery_number}).then(function(){var a=Object(l["a"])(regeneratorRuntime.mark((function a(r){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=r.value,a.next=3,t.$post("yuanyi_deliveries/confirm",{id:e.id,number:n});case 3:a.sent,t.$common.notify(),t.query();case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(){})),a.abrupt("return");case 2:case"end":return a.stop()}}),a)})))()},init:function(){this.arr[0].data=this.$vuexData.x.customer,this.arr[1].data=this.$vuexData.x.member_options,this.arr[2].data=this.$vuexData.x.member_options,this.arr[3].data=[{id:0,name:"发货单"},{id:1,name:"送货单"}],this.arr[6].data=this.$vuexData.x.contact_name_options,this.arr[7].data=this.$vuexData.x.contact_company_options}},mounted:function(){var e=this;this.query(),this.init(),this.$bus.$on("user",(function(){e.init()}))}},c=o,d=a("0c7c"),s=Object(d["a"])(c,r,n,!1,null,"74f6725a",null);t["default"]=s.exports}}]);