(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ReviewDepot~outDepot"],{"0820":function(e,t,a){"use strict";var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail"},[a("el-row",{attrs:{gutter:10,type:"flex",align:"middle",justify:"end"}},[a("el-col",{staticClass:"d-f-e d-f-c",attrs:{span:24}},[e.receiptShow?[a("span",{staticClass:"mr-10"},[e._v(e._s(e.fontSizes))]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSizes--}}},[e._v("A-")]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSizes++}}},[e._v("A+")])]:[a("span",{staticClass:"mr-10"},[e._v(e._s(e.fontSize))]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize--}}},[e._v("A-")]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(t){e.fontSize++}}},[e._v("A+")])],a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("p",[e._v("确定"+e._s(e.outbound_task.status?"红冲":"审核出库")+"吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.audit}},[e._v("确定")])],1),a("el-button",{staticClass:"mr-10",attrs:{slot:"reference",type:"primary",size:"small"},slot:"reference"},[e._v(e._s(e.outbound_task.status?"红冲":"审核出库"))])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.receiptShow,expression:"!receiptShow"}]},[a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#receipt",expression:"'#receipt'"}],attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:e.printReceipt}},[e._v("打印单据")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#receipt",expression:"'#receipt'"}],attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:e.print}},[e._v("打印单据(无金额)")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:function(t){return e.flowPrint(!0)}}},[e._v("合同号流程单")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:function(t){return e.flowPrint(!1)}}},[e._v("打印流程单")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.receiptShow,expression:"receiptShow"}]},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:e.printReceipt}},[e._v("打印单据")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:e.print}},[e._v("打印单据(无金额)")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#detailOutDepot",expression:"'#detailOutDepot'"}],attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:function(t){return e.flowPrint(!0)}}},[e._v("合同号流程单")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#detailOutDepot",expression:"'#detailOutDepot'"}],attrs:{type:"primary",size:"small",icon:"el-icon-printer"},on:{click:function(t){return e.flowPrint(!1)}}},[e._v("打印流程单")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.hideLineFn}},[e._v(e._s(e.hideLine?"隐藏":"显示"))])],1),a("el-button",{staticClass:"ml-10",attrs:{type:"warning",size:"small"},on:{click:function(t){return e.updateDetail(0)}}},[e._v("复制")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updateDetail(e.editID)}}},[e._v("修改")]),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.visibleSelf,callback:function(t){e.visibleSelf=t},expression:"visibleSelf"}},[a("p",[e._v("确定作废吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visibleSelf=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.invalidSelf}},[e._v("确定")])],1),a("el-button",{staticClass:"ml-10",attrs:{slot:"reference",type:"primary",size:"small"},slot:"reference"},[e._v("作废")])],1)],2)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.receiptShow,expression:"receiptShow"}],ref:"detailOutDepot",staticClass:"pt-10",attrs:{id:"detailOutDepot"}},[a("div",{staticClass:"header"},[e._v(e._s(e.outbound_task.contact_company)+" 发货流程单")]),a("ul",{staticClass:"d-f-s-b"},[a("li",[e._v("发货单号 : "+e._s(e.outbound_task.outbound_task_serial))]),a("li",[e._v("配货员 : "+e._s(e.outbound_task.delivery_member_name))]),a("li",[e._v("检验员 : "+e._s(e.outbound_task.check_member_name))]),a("li",[e._v("运单号码 : "+e._s(e.outbound_task.delivery_serial))]),a("li")]),a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[e._l(e.arr.length,(function(t){return a("tr",{key:"s"+t},e._l(e.arr[t-1],(function(n){return a("td",{key:n.label+t},[n.hideLine?e._e():a("div",{staticClass:"d-f-c"},[a("div",{staticClass:"W-80 t-j w-s-n"},[e._v(e._s(n.label)+"：")]),a("div",[e._v(e._s(e.outbound_task[n.id]||""))])])])})),0)})),e.hideLine?a("tr",[a("td",{attrs:{colspan:"3"}},[a("div",[e._v("备注："+e._s(e.outbound_task.desc_note))])])]):e._e()],2),e._l(e.headerArr,(function(t,n){return a("table",{key:t,staticClass:"table",class:{"always-table":t},style:{fontSize:e.fontSizes+"px"},attrs:{border:"1",cellspacing:"0"}},[a("tr",{staticClass:"header-tr",staticStyle:{"font-weight":"bold"},on:{dblclick:function(){e.headerArr.splice(e.headerArr.findIndex((function(e){return e===t})),1)}}},[a("td",{staticStyle:{width:"3%"}},[e._v("编号")]),a("td",{staticStyle:{width:"25%"}},[e._v("商品全名")]),e.hideLine?a("td",{staticStyle:{width:"8%"}},[e._v("CB")]):e._e(),a("td",{staticStyle:{width:"8%"}},[e._v("跟单员")]),e.hideLine?a("td",{staticStyle:{width:"8%"}},[e._v("代码2")]):e._e(),a("td",{staticStyle:{width:"8%"}},[e._v("数量")]),a("td",{staticStyle:{width:"8%"}},[e._v("备次")]),a("td",{staticStyle:{width:"10%"}},[e._v("订单编号")]),a("td",{staticStyle:{width:"14%"}},[e._v("备注 / 库位")]),e.contract_serial?a("td",{staticStyle:{width:"8%"}},[e._v("合同号")]):e._e()]),e._l(e.tableData.slice(t,1===e.headerArr.length?e.tableData.length:e.headerArr[n+1]),(function(n,r){return[a("tr",{key:"nvb"+r,on:{dblclick:function(a){return e.always(r+t)}}},[a("td",{staticClass:"t-c"},[e._v(e._s(r+t+1))]),a("td",[e._v(e._s(n.product_name))]),e.hideLine?a("td",[e._v(e._s(n.product_code1))]):e._e(),a("td",[e._v(e._s(n.tracking_member_name))]),e.hideLine?a("td",[e._v(e._s(n.product_code2))]):e._e(),a("td",[e._v(e._s(n.product_number))]),a("td",[e._v(e._s(n.sparetime))]),a("td",[e._v(e._s(n.order_serial))]),a("td",[e._v(" "+e._s((n.note||"")+" / "+(n.warehouse_location||""))+" ")]),e.contract_serial?a("td",[e._v(e._s(n.contract_serial))]):e._e()])]}))],2)})),a("div",{staticClass:"d-f-e mt-10 f-20"},[e._v("打印日期 : "+e._s(e.date))])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.receiptShow,expression:"!receiptShow"}],attrs:{id:"receipt"}},e._l(Math.ceil(e.tableData.length/8),(function(t){return a("div",{key:"ss"+t,staticClass:"box"},[a("div",{staticClass:"header"},[e._v("江苏源艺包装送货单")]),e._m(0,!0),a("div",{staticClass:"mb-5 mt-5"},[e._v("发货日期："+e._s(e.outbound_task.delivery_date))]),a("ul",{staticClass:"d-f-s-b mb-5 mt-5"},[a("li",[e._v("购买单位："+e._s(e.outbound_task.contact_company))]),a("li",[e._v("收件人："+e._s(e.outbound_task.contact_name))]),a("li",[e._v("电话："+e._s(e.outbound_task.contact_way))]),a("li",[e._v("地址："+e._s(e.outbound_task.delivery_address))])]),a("table",{staticClass:"table",style:{fontSize:e.fontSize+"px"},attrs:{border:"1",cellspacing:"0"}},[a("tr",{style:{fontWeight:"bold"}},[a("td",[e._v("商品编号")]),a("td",{staticStyle:{width:"34%"}},[e._v("商品全名")]),a("td",{staticClass:"w-s-n"},[e._v("单位")]),a("td",[e._v("数量")]),a("td",[e._v("单价")]),a("td",[e._v("金额")]),a("td",{staticStyle:{width:"20%"}},[e._v("备注 / 库位")]),a("td",[e._v("合同号")])]),e._l(e.tableData.slice(8*(t-1),8*t),(function(n,r){return[a("tr",{key:"nvb"+r},[a("td",[e._v(e._s(8*(t-1)+r+1))]),a("td",[e._v(e._s(n.product_name))]),a("td",{staticClass:"w-s-n"},[e._v(e._s(n.product_serial))]),a("td",[e._v(e._s(n.product_number))]),a("td",[e._v(e._s(e.noShow?"":n.price))]),a("td",[e._v(" "+e._s(e.noShow?"":(n.product_number*n.price).toFixed(2))+" ")]),a("td",[e._v(" "+e._s((n.note||"")+" / "+(n.warehouse_location||""))+" ")]),a("td",[e._v(e._s(n.contract_serial))])])]})),a("tr",[a("td",[e._v("合计")]),a("td"),a("td"),a("td"),a("td"),a("td",[e._v(" "+e._s(e.noShow?"":e.tableData.slice(8*(t-1),8*t).map((function(e){return(e.product_number||0)*(e.price||0)})).reduce((function(e,t){return e+t})).toFixed(2))+" ")]),a("td"),a("td")])],2),e._m(1,!0),a("el-row",{staticClass:"d-f-s-b mb-5 mt-5"},[a("el-col",{attrs:{span:8}},[e._v("制单人："+e._s(e.outbound_task.maker))]),a("el-col",{attrs:{span:8}},[e._v("销售："+e._s(e.outbound_task.saler))]),a("el-col",{attrs:{span:8}},[e._v("收货单位及经手人（签字）：")])],1),a("el-row",{staticClass:"d-f-s-b mb-5 mt-5"},[a("el-col",{attrs:{span:8}},[e._v("送货人（签字）："+e._s(e.outbound_task.siji))]),a("el-col",{attrs:{span:8}},[e._v("负责人："+e._s(e.outbound_task.tracking_member))]),a("el-col",{attrs:{span:8}})],1)],1)})),0)],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"d-f-s-b mb-5 mt-5"},[a("li",[e._v("公司地址：江苏省常熟市尚湖镇练塘颜巷工业区")]),a("li",[e._v("电话：18261793098")]),a("li",[e._v("传真：52746532")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"note"},[a("li",[e._v("注：1. 需方在签收货物前对货物数量、规格、包装进行核对检验，核对无异后签收，签收后视为数量、规格、包装无异议；")]),a("li",[e._v(" 2. 质量异议期：如有异议，需方自签收之日起三日内向供方提出书面异议并需妥善保管货物不得使用货物；逾期未提异议或已使用货物的视为货物质量合格； ")]),a("li",[e._v("3. 油质，染料，化学剂，高温烫气及其他造成色纱，退色或污染，均非本公司产品瑕疵，需方使用前，请自行彻底测试。")]),a("li",[e._v("4. 货物交付履行地：常熟。")])])}],l=(a("4de4"),a("7db0"),a("d81d"),a("ade3")),o=(a("96cf"),a("1da1")),s=(n={name:"DetailOutDepot",props:{},components:{}},Object(l["a"])(n,"props",{detailData:{type:Object,default:function(){return{}}}}),Object(l["a"])(n,"data",(function(){return{hideLine:!0,visibleSelf:!1,date:"",fontSize:14,fontSizes:16,receiptShow:!1,contract_serial:!1,visible:!1,noShow:!1,outbound_task:{},tableData:[],editID:0,arr:[[{label:"跟单员",width:"25",id:"tracking_member_name"},{label:"业务员",width:"50",id:"saler_name"},{label:"发货日期",width:"25",id:"delivery_date"}],[{label:"收货单位",id:"contact_company",hideLine:!1},{label:"发货单位",id:"delivery_company"},{label:"货运方式",id:"huoyunfangshi"}],[{label:"收货人",id:"contact_name",hideLine:!1},{label:"发货人",id:"signment_member_name"},{label:"放单方式",id:"fangdanfangshi"}],[{label:"联系方式",id:"contact_way",hideLine:!1},{label:"联系方式",id:"delivery_contact_way"},{label:"付费方式",id:"fufeifangshi"}],[{label:"收货地址",id:"delivery_address",hideLine:!1},{label:"发货地址",id:"delivery_from"},{label:"特殊要求",id:"spec_note"}]],headerArr:[0]}})),Object(l["a"])(n,"methods",{hideLineFn:function(){this.hideLine=!this.hideLine,this.arr.map((function(e){e.map((function(e){!1===e.hideLine?e.hideLine=!0:!0===e.hideLine&&(e.hideLine=!1)}))}))},always:function(e){this.headerArr.filter((function(t){return t===e})).length||this.headerArr.push(e),this.headerArr=this.headerArr.sort((function(e,t){return e-t}))},init:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$post("outbound_tasks/for_show",{id:e.id});case 2:n=a.sent,t.tableData=n.data.data.products,t.outbound_task=n.data.data.outbound_task,t.editID=e.id,t.date=moment().format("YYYY-MM-DD HH:mm:ss");case 7:case"end":return a.stop()}}),a)})))()},printReceipt:function(){this.receiptShow=!1},print:function(){var e=this;this.receiptShow=!1,this.noShow=!0,setTimeout((function(){e.noShow=!1}))},flowPrint:function(e){this.receiptShow=!0,this.contract_serial=e,this.date=moment().format("YYYY-MM-DD HH:mm:ss")},audit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.outbound_task.status){t.next=5;break}if(a=e.tableData.find((function(e){return!e.product_number})),!a){t.next=5;break}return e.$notify({title:"提示",type:"error",message:"".concat(a.product_name," 数量为0不允许审核出库！")}),t.abrupt("return");case 5:return e.visible=!1,t.next=8,e.$post(e.outbound_task.status?"outbound_tasks/red_dashed":"outbound_tasks/pass_audit",{id:e.editID});case 8:t.sent,e.$notify({title:"提示",type:"success",message:"".concat(e.outbound_task.status?"红冲":"审核出库","成功！")}),e.$emit("cancel");case 11:case"end":return t.stop()}}),t)})))()},invalidSelf:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.visibleSelf=!1,t.next=3,e.$post("outbound_tasks/invalid_self",{id:e.editID});case 3:t.sent,e.$notify({title:"提示",type:"success",message:"作废成功！"}),e.$emit("cancel");case 6:case"end":return t.stop()}}),t)})))()},updateDetail:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$emit("update",{outbound_task:this.outbound_task,tableData:this.tableData,id:e})}}),Object(l["a"])(n,"beforeDestroy",(function(){this.$bus.$off("detailShow")})),Object(l["a"])(n,"mounted",(function(){var e=this;this.$bus.$on("detailShow",(function(t){e.init(t)}))})),n),c=s,u=(a("cd4f"),a("0c7c")),d=Object(u["a"])(c,r,i,!1,null,"2c547d30",null);t["a"]=d.exports},"139e":function(e,t,a){},"55a1":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-outdepot"},[e.panelType?a("Panel",{attrs:{arr:e.arr},on:{change:e.custChange}}):e._e(),a("div",{staticClass:"d-f-s-b pt-10 pb-10",class:{"d-f-e":e.finance}},[e.finance?e._e():a("el-button",{attrs:{type:"primary",size:"large"},on:{click:e.changeDialog}},[e._v("选择出库产品")]),a("div",[a("el-button",{attrs:{size:"large"},on:{click:function(t){return e.cancel(1)}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"large"},on:{click:e.save}},[e._v("保存")])],1)],1),a("el-table",{ref:"dialog1Table",attrs:{data:e.tableData,border:"",height:"310"}},[a("el-table-column",{attrs:{label:"序号",align:"center",prop:"product_name","header-align":"center",type:"index"}}),a("el-table-column",{attrs:{label:"订单编号",align:"center",prop:"order_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品名称",align:"center",prop:"product_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"仓库选择",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:""},model:{value:t.row["inbound_warehouse_id"],callback:function(a){e.$set(t.row,"inbound_warehouse_id",a)},expression:"scope.row['inbound_warehouse_id']"}},e._l(e.$vuexData.x.warehouse,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}])}),a("el-table-column",{attrs:{label:"仓位选择",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Page",{attrs:{clearable:!0,data:e.$vuexData.x.location},model:{value:t.row["warehouse_location_id"],callback:function(a){e.$set(t.row,"warehouse_location_id",a)},expression:"scope.row['warehouse_location_id']"}})]}}])}),a("el-table-column",{attrs:{label:"订单数量",align:"center",prop:"order_quantity","header-align":"center"}}),a("el-table-column",{attrs:{label:"当前库存",align:"center",prop:"storage_quantity","header-align":"center",width:"100"}}),a("el-table-column",{attrs:{label:"出库数量",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"product_number",arr:e.focussArr},expression:"{\n            index: scope.$index,\n            name: 'product_number',\n            arr: focussArr\n          }"}],attrs:{placeholder:""},on:{change:function(a){return e.numberChange(t.row)}},model:{value:t.row["product_number"],callback:function(a){e.$set(t.row,"product_number",a)},expression:"scope.row['product_number']"}})]}}])}),a("el-table-column",{attrs:{label:"备次",align:"center",prop:"sparetime","header-align":"center",width:"100"}}),a("el-table-column",{attrs:{label:"备次率(%)",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"sparetime_percent",arr:e.focussArr},expression:"{\n            index: scope.$index,\n            name: 'sparetime_percent',\n            arr: focussArr\n          }"}],attrs:{placeholder:""},on:{change:function(a){return e.percentChange(t.row)}},model:{value:t.row["sparetime_percent"],callback:function(a){e.$set(t.row,"sparetime_percent",a)},expression:"scope.row['sparetime_percent']"}})]}}])}),a("el-table-column",{attrs:{label:"产品单价",align:"center","header-align":"center",prop:"price",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"price",arr:e.focussArr},expression:"{\n            index: scope.$index,\n            name: 'price',\n            arr: focussArr\n          }"}],attrs:{placeholder:""},on:{change:function(a){return e.numChange(t.row,"price")}},model:{value:t.row["price"],callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row['price']"}})]}}])}),a("el-table-column",{attrs:{label:"备注",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"note",arr:e.focussArr},expression:"{\n            index: scope.$index,\n            name: 'note',\n            arr: focussArr\n          }"}],attrs:{placeholder:""},model:{value:t.row["note"],callback:function(a){e.$set(t.row,"note",a)},expression:"scope.row['note']"}})]}}])}),e.finance?e._e():a("el-table-column",{attrs:{label:"操作",align:"center","header-align":"center",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"mr-3",attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.del(t.$index)}}})]}}],null,!1,1948525947)})],1),a("AddDialog",{attrs:{dialogVisibl:e.dialogShow},on:{cancel:function(t){e.dialogShow=!1},save:e.dialogSave}})],1)},r=[],i=(a("99af"),a("4de4"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("5530")),l=(a("96cf"),a("1da1")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"dialog",attrs:{title:"出入库产品选择",visible:e.dialogVisible,width:"85%",top:"5vh","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){return e.cancel(!1)}}},[a("el-card",{staticClass:"mb-10"},[a("el-row",{attrs:{gutter:20}},[a("el-form",{attrs:{"label-position":"left",inline:!0}},[a("el-col",{attrs:{span:"7"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:"客户名称："}},[a("Page",{attrs:{clearable:!0,placeholder:"请选择客户名称",data:e.$vuexData.x.customer},on:{change:e.custChange},model:{value:e.cust,callback:function(t){e.cust=t},expression:"cust"}})],1)],1),a("el-col",{attrs:{span:"5"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"订单编号/产品名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.query(t)}},model:{value:e.inputModel,callback:function(t){e.inputModel=t},expression:"inputModel"}})],1)],1),a("el-col",{attrs:{span:"5"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"合同号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.query(t)}},model:{value:e.contract_serial,callback:function(t){e.contract_serial=t},expression:"contract_serial"}})],1)],1),a("el-col",{attrs:{span:"7"}},[a("el-form-item",{staticClass:"form-item",attrs:{label:""}},[a("el-button",{staticClass:"f-r ml-10",attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),a("el-button",{staticClass:"f-r",attrs:{type:"warning"},on:{click:e.query}},[e._v("查询")])],1)],1)],1)],1)],1),a("div",{staticClass:"pt-10"},[a("el-table",{ref:"dialog1Table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"500"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","header-align":"center"}}),a("el-table-column",{attrs:{label:"订单编号",align:"center",prop:"order_serial","header-align":"center"}}),a("el-table-column",{attrs:{label:"产品名称",align:"center",prop:"product_name","header-align":"center"}}),a("el-table-column",{attrs:{label:"仓库选择",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{filterable:"",placeholder:""},model:{value:t.row["inbound_warehouse_id"],callback:function(a){e.$set(t.row,"inbound_warehouse_id",a)},expression:"scope.row['inbound_warehouse_id']"}},e._l(e.$vuexData.x.warehouse,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)]}}])}),a("el-table-column",{attrs:{label:"仓位选择",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Page",{attrs:{clearable:!0,data:e.$vuexData.x.location},model:{value:t.row["warehouse_location_id"],callback:function(a){e.$set(t.row,"warehouse_location_id",a)},expression:"scope.row['warehouse_location_id']"}})]}}])}),a("el-table-column",{attrs:{label:"订单数量",align:"center",prop:"order_quantity","header-align":"center"}}),a("el-table-column",{attrs:{label:"当前库存",align:"center",prop:"current_storage","header-align":"center",width:"100"}}),a("el-table-column",{attrs:{label:"出库数量",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"product_number",arr:e.focussArr},expression:"{\n              index: scope.$index,\n              name: 'product_number',\n              arr: focussArr\n            }"}],attrs:{placeholder:""},on:{change:function(a){return e.numberChange(t.row)}},model:{value:t.row["product_number"],callback:function(a){e.$set(t.row,"product_number",a)},expression:"scope.row['product_number']"}})]}}])}),a("el-table-column",{attrs:{label:"备次",align:"center",prop:"sparetime","header-align":"center",width:"100"}}),a("el-table-column",{attrs:{label:"备次率(%)",align:"center","header-align":"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"sparetime_percent",arr:e.focussArr},expression:"{\n              index: scope.$index,\n              name: 'sparetime_percent',\n              arr: focussArr\n            }"}],attrs:{placeholder:""},on:{change:function(a){return e.percentChange(t.row)}},model:{value:t.row["sparetime_percent"],callback:function(a){e.$set(t.row,"sparetime_percent",a)},expression:"scope.row['sparetime_percent']"}})]}}])}),a("el-table-column",{attrs:{label:"产品单价",align:"center","header-align":"center",prop:"price",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"price",arr:e.focussArr},expression:"{\n              index: scope.$index,\n              name: 'price',\n              arr: focussArr\n            }"}],attrs:{placeholder:""},on:{change:function(e){t.row["price"]=Number(parseFloat(t.row["price"]).toFixed(3))||0}},model:{value:t.row["price"],callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row['price']"}})]}}])}),a("el-table-column",{attrs:{label:"备注",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{directives:[{name:"focuss",rawName:"v-focuss",value:{index:t.$index,name:"note",arr:e.focussArr},expression:"{\n              index: scope.$index,\n              name: 'note',\n              arr: focussArr\n            }"}],attrs:{placeholder:""},model:{value:t.row["note"],callback:function(a){e.$set(t.row,"note",a)},expression:"scope.row['note']"}})]}}])})],1),a("el-pagination",{staticClass:"pt-10 d-f-e",attrs:{layout:"prev, pager, next","current-page":e.currentPage,total:e.total_count,background:"","page-size":20},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.currentChange}})],1)],1)},s=[],c=(a("4160"),a("caad"),a("2532"),a("159b"),{name:"AddDialog",props:{dialogVisibl:{type:Boolean,default:function(){return!1}}},data:function(){return{focussArr:["product_number","sparetime_percent","price","note"],multipleSelection:[],inputModel:"",contract_serial:"",cust:null,custData:[],dialogVisible:!1,tableData:[],total_count:1,currentPage:1}},watch:{dialogVisibl:function(e){e&&(this.dialogVisible=!0,this.tableData=[])}},methods:{custChange:function(){this.inputModel="",this.contract_serial="",this.query()},numberChange:function(e){e.product_number=parseInt(e.product_number)||0,e.sparetime=Math.ceil(e.product_number*e.sparetime_percent/100)||0},percentChange:function(e){e.sparetime_percent=Number(e.sparetime_percent)||0,e.sparetime=Math.ceil(e.product_number*e.sparetime_percent/100)||0},handleSelectionChange:function(e){this.multipleSelection=e},cancel:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",e),this.dialogVisible=!1},currentChange:function(){this.query()},query:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={page:e.currentPage,query_key:e.inputModel,customer_id:e.cust,contract_serial:e.contract_serial},t.next=3,e.$post("outbound_tasks/choose_products",a);case 3:n=t.sent,n=n.data.data,r=e.multipleSelection,i=n.items.filter((function(t){return!e.multipleSelection.map((function(e){return e.product_id})).includes(t.product_id)})),i.map((function(e,t){e.sparetime=0})),e.tableData=e.multipleSelection.concat(i),e.$nextTick((function(){r.forEach((function(t){e.$refs.dialog1Table.toggleRowSelection(t)}))})),e.total_count=n.paginate_meta.total_count;case 11:case"end":return t.stop()}}),t)})))()},save:function(){this.multipleSelection.length?(this.$emit("save",this.multipleSelection),this.cancel()):this.$notify({title:"警告",message:"你未选中任何一条数据，请检查！",type:"warning"})}},beforeDestroy:function(){this.$bus.$off("AddOutDepot")},mounted:function(){var e=this;this.$bus.$on("AddOutDepot",(function(t){e.cust=t,e.query()}))}}),u=c,d=a("0c7c"),p=Object(d["a"])(u,o,s,!1,null,"c1906962",null),m=p.exports,_={name:"add",props:{},components:{AddDialog:m},data:function(){return{focussArr:["product_number","sparetime_percent","price","note"],panelType:!1,finance:0,dialogShow:!1,tableData:[],editId:0,arr:[{label:"下单客户",model:"",placeholder:"",id:"customer_id",type:"page",data:[],clearable:!1},{label:"发货日期",model:"",placeholder:"",id:"delivery_date",type:"date",data:[]},{label:"发货单号",model:"",placeholder:"",id:"outbound_task_serial"},{label:"运单号码",model:"",placeholder:"",id:"delivery_serial"},{label:"收货单位",model:"",placeholder:"",id:"contact_company"},{label:"发货单位",model:"",placeholder:"",id:"delivery_company"},{label:"货运方式",model:"",placeholder:"",id:"huoyunfangshi",type:"select",data:[]},{label:"检验员",model:"",placeholder:"",id:"check_member_id",type:"select",data:[]},{label:"收货人",model:"",placeholder:"",id:"contact_name"},{label:"发货人",model:"",placeholder:"",id:"signment_member_id",type:"select",data:[]},{label:"放单方式",model:"",placeholder:"",id:"fangdanfangshi",type:"select",data:[]},{label:"业务员",model:"",placeholder:"",id:"saler_id",type:"select",data:[]},{label:"联系方式",model:"",placeholder:"收货人联系方式",id:"contact_way"},{label:"联系方式",model:"",placeholder:"发货人联系方式",id:"delivery_contact_way"},{label:"付费方式",model:"",placeholder:"",id:"fufeifangshi",type:"select",data:[]},{label:"跟单员",model:"",placeholder:"",id:"tracking_member_id",type:"select",data:[]},{label:"收货地址",model:"",placeholder:"",id:"delivery_address"},{label:"发货地址",model:"",placeholder:"",id:"delivery_from"},{label:"特殊要求",model:"",placeholder:"",id:"spec_note"},{label:"配货员",model:"",placeholder:"",id:"delivery_member_id",type:"select",data:[]},{label:"备注说明",model:"",placeholder:"",id:"desc_note",class:"w-100"}]}},methods:{init:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.arr.map((function(e){e.model=""})),a=e.$vuexData.x,e.arr[0].data=a.customer,e.arr[0].model=a.customer[0].id,e.arr[10].data=a.fangdanfangshi,e.arr[14].data=a.fufeifangshi,e.arr[6].data=a.huoyunfangshi,[19,7,15,11,9].map((function(t){e.arr[t].data=a.member})),t.next=10,e.custChange({model:a.customer[0].id,id:"customer_id"});case 10:e.arr[1].model=moment().format("YYYY-MM-DD"),e.tableData=[],e.arr[17].model="常熟市尚湖镇练墉颜巷工业园";case 13:case"end":return t.stop()}}),t)})))()},changeDialog:function(){this.dialogShow=!0,this.$bus.$emit("AddOutDepot",this.arr[0].model)},dialogSave:function(e){this.tableData=this.tableData.concat(e)},numberChange:function(e){e.product_number=parseInt(e.product_number)||0,e.sparetime=Math.ceil(e.product_number*e.sparetime_percent/100)||0},percentChange:function(e){e.sparetime_percent=Number(e.sparetime_percent)||0,e.sparetime=Math.ceil(e.product_number*e.sparetime_percent/100)||0},numChange:function(e,t){e[t]=Number(Number(e[t]).toFixed(3)||0)},del:function(e){this.tableData.splice(e,1)},custChange:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("customer_id"===e.id){a.next=2;break}return a.abrupt("return");case 2:return t.arr[4].model=t.$vuexData.x.customer.filter((function(t){return t.id===e.model}))[0].name,a.next=5,t.$post("outbound_tasks/switch_customer",{customer_id:e.model});case 5:n=a.sent,r=n.data.data,t.arr[15].model=r.tracking_member_id,t.arr[11].model=r.saler_member_id,t.arr[5].model=r.delivery_company||"源艺包装",t.arr[9].model=r.signment_member_id,t.arr[13].model=r.delivery_contact_way;case 12:case"end":return a.stop()}}),a)})))()},save:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={},e.arr.map((function(e){a[e.id]=e.model})),a.delivery_date=moment(a.delivery_date).format("YYYY-MM-DD"),n=e.tableData.map((function(e){return Object(i["a"])(Object(i["a"])({},{inbound_warehouse_id:null,warehouse_location_id:null,storage_quantity:null,product_number:null,sparetime:null,sparetime_percent:null,note:null}),e)})),r={},n.map((function(t,a){t.id=e.editId?t.id:"",r[a]=t})),l={outbound_task:a,products:r},e.editId&&(l.id=e.editId),!e.finance){t.next=19;break}return l.status=2,t.next=12,e.$post("outbound_tasks/".concat(e.editId?"for_update":"for_create"),l);case 12:return t.sent,t.next=15,e.$post("outbound_tasks/finacal_audit",{id:e.editId});case 15:return t.sent,e.$notify({title:"提示",type:"success",message:"财务审核成功！"}),e.cancel(),t.abrupt("return");case 19:return t.next=21,e.$post("outbound_tasks/".concat(e.editId?"for_update":"for_create"),l);case 21:if(t.sent,e.$notify({title:"提示",type:"success",message:"".concat(e.editId?"修改":"创建","成功！")}),!e.editId){t.next=26;break}return e.$emit("detail",{id:e.editId}),t.abrupt("return");case 26:e.cancel();case 27:case"end":return t.stop()}}),t)})))()},cancel:function(e){this.$emit("cancel",e)},getSerial:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$post("outbound_tasks/for_new");case 2:a=t.sent,e.arr[2].model=a.data.data.outbound_task.outbound_task_serial;case 4:case"end":return t.stop()}}),t)})))()}},beforeDestroy:function(){this.$bus.$off("panelShow")},mounted:function(){var e=this;this.$bus.$on("panelShow",function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:a?(e.tableData=a.tableData,e.arr.map((function(e){e.model=a.outbound_task[e.id]})),e.editId=a.id,e.finance=a.type,e.panelType=!0,a.id||(e.getSerial(),e.arr[1].model=moment().format("YYYY-MM-DD"))):(e.panelType=!0,e.getSerial());case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},f=_,b=Object(d["a"])(f,n,r,!1,null,"0153776a",null);t["a"]=b.exports},"7db0":function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").find,i=a("44d2"),l=a("ae40"),o="find",s=!0,c=l(o);o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(o)},a434:function(e,t,a){"use strict";var n=a("23e7"),r=a("23cb"),i=a("a691"),l=a("50c4"),o=a("7b0b"),s=a("65f0"),c=a("8418"),u=a("1dde"),d=a("ae40"),p=u("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),_=Math.max,f=Math.min,b=9007199254740991,h="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!p||!m},{splice:function(e,t){var a,n,u,d,p,m,v=o(this),g=l(v.length),w=r(e,g),y=arguments.length;if(0===y?a=n=0:1===y?(a=0,n=g-w):(a=y-2,n=f(_(i(t),0),g-w)),g+a-n>b)throw TypeError(h);for(u=s(v,n),d=0;d<n;d++)p=w+d,p in v&&c(u,d,v[p]);if(u.length=n,a<n){for(d=w;d<g-n;d++)p=d+n,m=d+a,p in v?v[m]=v[p]:delete v[m];for(d=g;d>g-n+a;d--)delete v[d-1]}else if(a>n)for(d=g-n;d>w;d--)p=d+n-1,m=d+a-1,p in v?v[m]=v[p]:delete v[m];for(d=0;d<a;d++)v[d+w]=arguments[d+2];return v.length=g-n+a,u}})},cd4f:function(e,t,a){"use strict";var n=a("139e"),r=a.n(n);r.a}}]);