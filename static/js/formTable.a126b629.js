(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["formTable"],{"07dc":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plan box p-10"},[a("Panel",{attrs:{arr:t.arr},on:{change:t.change,dateChange:t.dateChange}}),a("div",{staticClass:"pt-10 table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),a("el-table-column",{attrs:{prop:"customer_name",label:"客户名称"}}),a("el-table-column",{attrs:{prop:"bill_total_price",label:"总应收款"}}),a("el-table-column",{attrs:{prop:"date_bill_price",label:"到期应收款"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"warning",underline:!1},on:{click:function(a){return t.showDetail(e.row)}}},[t._v(t._s(e.row.date_bill_price))])]}}])}),a("el-table-column",{attrs:{prop:"test1",label:"总应付款"}}),a("el-table-column",{attrs:{prop:"test2",label:"账期应付款"}})],1)],1),a("Detail",{attrs:{centerDialogVisible:t.visble,detailData:t.detailData},on:{cancel:function(e){t.visble=!1}}})],1)},i=[],r=(a("d81d"),a("5530")),l=(a("96cf"),a("1da1")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"dialog",attrs:{title:"",visible:t.dialogVisible,width:"96%",top:"10vh"},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){return t.cancel(!1)}}},[a("div",{ref:"printMe",style:{fontSize:t.fontSize+"px"},attrs:{id:"printMe"}},[a("table",{staticClass:"table",attrs:{border:"1",cellspacing:"0"}},[a("tr",{staticStyle:{"background-color":"#5491ff"}},t._l(t.arr,(function(e){return a("td",{key:e.label,style:{width:e.width}},[t._v(t._s(e.label))])})),0),t._l(t.tableData,(function(e,n){return[n>0&&t.tableData[n-1].receiving_unit!==t.tableData[n].receiving_unit?a("tr",{key:e.product_name+n,staticStyle:{height:"10px"}}):t._e(),a("tr",{key:e.receiving_unit+n},t._l(t.arr,(function(i){return a("td",{key:i.id},[t._v(t._s("index"!==i.id?e[i.id]:n+1))])})),0)]}))],2)]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(e){t.fontSize--}}},[t._v("A-")]),a("el-link",{staticStyle:{"margin-right":"20px"},attrs:{underline:!1,type:"primary"},on:{click:function(e){t.fontSize++}}},[t._v("A+")]),a("el-button",{ref:"daochu",attrs:{type:"primary"},on:{click:t.exports}},[t._v("导出")]),a("el-button",{directives:[{name:"print",rawName:"v-print",value:"#printMe",expression:"'#printMe'"}],ref:"printButton",attrs:{type:"primary"}},[t._v("打印")]),a("el-button",{on:{click:function(e){return t.cancel(!1)}}},[t._v("取消")])],1)])},c=[],s=(a("99af"),a("4160"),a("13d5"),a("c19f"),a("b64b"),a("d3b7"),a("3ca3"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("159b"),a("ddb0"),a("2b3d"),{name:"Dialog5",props:{centerDialogVisible:{type:Boolean,default:function(){return!1}},detailData:{type:Object,default:function(){return{}}},print:{type:Boolean,default:!1}},computed:{},data:function(){return{fontSize:14,dialogVisible:!1,tableData:[],headerData:{},arr:[{label:"行号",width:"20px",id:"index"},{label:"发货日期",id:"delivery_date"},{label:"单号",id:"outbound_task_serial"},{label:"类型",id:"outbound_type"},{label:"金额",id:"product_amount"},{label:"累计",id:"total_amount"},{label:"产品名称",id:"produce_name"},{label:"备注",id:"note"},{label:"单位",id:"product_unit"},{label:"产品数量",id:"product_number"},{label:"产品单价",id:"product_price"}]}},watch:{centerDialogVisible:function(t){t&&(this.dialogVisible=!0)},detailData:function(t){t&&(this.headerData=this.detailData.labels,this.tableData=this.detailData.outbound_bills_detail)},print:function(t){var e=this;t&&(this.dialogVisible=!0,this.$nextTick((function(){e.$refs.printButton.$el.click()})))}},methods:{exports:function(){var t=this,e="用户统计2020-01-10-2020-01-12",a={bookType:"xlsx",bookSST:!0,type:"binary",cellStyles:!0},n=JSON.parse(JSON.stringify(this.tableData)),i=[];n.map((function(e,a){i[a]={},t.arr.map((function(t){i[a][t.label]="index"===t.id?a+1:e[t.id]}))})),this.downloadExl(i,a,e)},saveAs:function(t,e){var a=document.createElement("a");a.download=e||"未命名","msSaveOrOpenBlob"in navigator?window.navigator.msSaveOrOpenBlob(t,"下载的文件名.xlsx"):a.href=URL.createObjectURL(t),a.click(),setTimeout((function(){URL.revokeObjectURL(t)}),100)},downloadExl:function(t,e,a){var n=this,i=t[0];t.unshift({});var r=[];for(var l in i)r.push(l),t[0][l]=l;i=[];var o=t.map((function(t,e){var a=r.map((function(a,i){return Object.assign({},{v:t[a],position:(i>25?n.getCharCol(i):String.fromCharCode(65+i))+(e+1)})}));return a}));this.headerData;o.reduce((function(t,e){return t.concat(e)})).forEach((function(t,e){return i[t.position]={v:t.v}}));var c=Object.keys(i);["A","B","C","D","E","F","G","H","I","J","K"].map((function(t){i["".concat(t,"1")].s={font:{sz:14,bold:!0,vertAlign:!0},alignment:{vertical:"center",horizontal:"center"},fill:{bgColor:{rgb:"5491ff"},fgColor:{rgb:"5491ff"}}}})),i["!cols"]=[{wpx:50},{wpx:80},{wpx:130},{wpx:100},{wpx:100},{wpx:100},{wpx:150},{wpx:100},{wpx:100},{wpx:100},{wpx:100}];var s={SheetNames:["mySheet"],Sheets:{mySheet:Object.assign({},i,{"!ref":c[0]+":"+c[c.length-1]})}},d=new Blob([this.s2ab(XLSX.write(s,{bookType:void 0==e?"xlsx":e.bookType,bookSST:!1,type:"binary"}))],{type:""});this.saveAs(d,"".concat(new Date)+"."+("biff2"==e.bookType?"xls":e.bookType))},getCharCol:function(t){var e="",a=0;while(t>0)a=t%26+1,e=String.fromCharCode(a+64)+e,t=(t-a)/26;return e},s2ab:function(t){if("undefined"!==typeof ArrayBuffer){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}for(var i=new Array(t.length),r=0;r!=t.length;++r)i[r]=255&t.charCodeAt(r);return i},cancel:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("cancel",t),this.dialogVisible=!1}}}),d=s,u=(a("45cb"),a("0c7c")),b=Object(u["a"])(d,o,c,!1,null,"20f5b8e6",null),p=b.exports,f={name:"Plan",props:{},data:function(){return{arr:[{label:"销售",model:"",placeholder:"",type:"page",data:[],id:"saler_id"},{label:"客户",model:"",placeholder:"",type:"page",data:[],id:"customer_id"},{label:"发货日期",span:"8",model:"all",placeholder:"",type:"filter",data:[{name:"全部",id:"all"},{name:"本月",id:"month"},{name:"本季度",id:"quarter"},{name:"本年",id:"year"},{name:"自定义日期",id:"custom"}],id:"outbounded_at"}],tableData:[],visble:!1,detailData:{},date:[]}},watch:{},computed:{},components:{Detail:p},methods:{query:function(){var t=arguments,e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,i,l,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:null,i={saler_id:e.arr[0].model,customer_id:e.arr[1].model,outbounded_at:e.arr[2].model},n&&(i=Object(r["a"])(Object(r["a"])({},i),n)),a.next=5,e.$post("/outbound_tasks/outbound_bills",i);case 5:l=a.sent,o=l.data.data.outbound_bills,e.tableData=[],o.map((function(t){t.test1=0,t.test2=0})),e.$nextTick((function(){e.tableData=o}));case 10:case"end":return a.stop()}}),a)})))()},init:function(){var t=this.$vuexData.x;this.arr[0].data=t.member,this.arr[1].data=t.customer},dateChange:function(t){this.date=[moment(t[0]).format("YYYY-MM-DD"),moment(t[1]).format("YYYY-MM-DD")],this.query({date_min:this.date[0],date_max:this.date[1]})},change:function(t){"custom"!==t.model&&this.query()},showDetail:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={saler_id:e.arr[0].model,customer_id:t.customer_id,outbounded_at:e.arr[2].model},"custom"===e.arr[2].model&&(n=Object(r["a"])(Object(r["a"])({},n),{date_min:e.date[0],date_max:e.date[1]})),a.next=4,e.$post("/outbound_tasks/outbound_bills_detail",n);case 4:i=a.sent,e.detailData=i.data.data,e.visble=!0;case 7:case"end":return a.stop()}}),a)})))()}},mounted:function(){var t=this;this.init(),this.$bus.$on("user",(function(){t.init()})),this.query()}},h=f,m=Object(u["a"])(h,n,i,!1,null,"2521015e",null);e["default"]=m.exports},2121:function(t,e,a){},"45cb":function(t,e,a){"use strict";var n=a("2121"),i=a.n(n);i.a}}]);